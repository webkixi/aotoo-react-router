{"version":3,"sources":["index.js"],"names":["ProgressFun","props","_props","_","merge","style","enable","React","createElement","className","width","_os","ua","OPACITY","android","state","match","curState","opacity","ret","mobile","ios","cb","get","operateId","Progress","operate","this","once","set","stat","params","anchorHref","nohash","anchorHash","flag","uri","rootUrl","key","window","history","pushState","update","value","cache","size","max","Object","create","_cache","undefined","v","remove","clear","_aotooReactTabs","require","Popstate","SAX","_history","_historyCount","_leftStack","os","Aotoo","inject","css","ProgressClass","_classCallCheck","_this","_possibleConstructorReturn","__proto__","getPrototypeOf","call","backgroundColor","height","Component","console","log","WIDTH","ostate","opts","navigator","userAgent","document","addEventListener","e","target","nodeName","href","indexOf","blockPopstateEvent","readyState","evt","setTimeout","stopImmediatePropagation","preventDefault","lru","_lru","animatecss","fade","in","out","back","rein","left","right","extend","utile","dft","storage","sessionStorage","__opts","progress","routerClass","likeApp","mulitple","Router","_Tabs","_this2","location","split","direction","animate","prePageInfo","animateType","historyPush","bind","getRealContent","findPath","_inherits","Tabs","_createClass","_get","prototype","that","animateback","menuData","saxer","MenuData","ContentData","select","on","_path","path","_data","data","historyItem","index","emit","where","type","_typeof","menu_data","curHistoryState","preState","timeLine","length","push","rightState","pop","InstanceContext","pre","from","_pre","idf","parent","attr","selectData","cnt","result","enter","main","title","id","prePage","preContent","oriContent","content","rightIndex","findLastIndex","o","slice","_extends","getContent","uniqueId","boxCls","origin","curPage","ref","leave","animatein","animateout","animaterein","curPageDom","prePageDom","refs","classList","leaveContent","cls","boxes_cls","jsxMenu","getPage","IscrollTreeMenu","iscroll","iscrollConfig","Action","UPDATE","ctx","SELECT","showMenu","router","__id","condition","preback","context","$width","$opacity","param","end","timeout","arguments","xxid","find","record","stack","start","hasMounted","goto","config","delete","sessName","storageName","timmer","removeItem","getWhereInfo","name","JSON","stringify","getHistory","cur","current","setItem","sessData","restore","parse","page","next","gap","result_beforegoto","_this3","setHistory","resultBeforegoto","result_beforeback","_this4","resultBeforeback","$select","hasOn","h","whereami","whereBack"],"mappings":"wnBAmCI,SAAAA,YAAAC,GAAA,IAAKC,EAAAC,EAAUC,SAAAH,GAAf,OACEC,EAAAG,OAAAH,EAAAG,MAAKC,eAAUJ,EAAAG,MAAgBC,OAGpCC,MAAAC,cAAA,OAAAC,UAAA,iBAHKF,MAAAC,cAAA,OAAKC,UAAU,gBAAgBJ,MAAOH,EAAOG,QAAQK,MAAO,QA+B/D,SALmCC,IAAAC,GAMpCC,IAAAA,KACEC,EAAIC,EAAQC,MAAKC,iCACjBF,EAAMG,EAAAA,MAAN,sCAED,OADCC,EAAAC,UAAAN,IAAAO,GACDF,EAID,SAAIA,KAAJG,GAAA,IAEED,EADAP,KAAUF,MAAAW,IAAS,QACJ,WACbH,EAAYN,KAAAA,MAAWO,IAA3BG,GAED,GADCC,SAAON,QAAPT,MAAA,QACDgB,EAAA,CASG,GAAe,SAAXA,EAAoB,OAN5BC,KAASC,MAATC,IAAkBL,EAAA,cAGhBG,KAAMD,MAAAA,IAAUF,EAAA,SAKZM,OACDA,MAAA,EAJHR,EAAA,SAAaS,GACXD,MAAIJ,KAyDFM,SAAAA,UAAa/B,EAAbgC,GACAC,IAAAA,EAAAA,EAAaC,KAAb,kBAAAlC,EAAAkC,KAAA,IAAAlC,EAAAkC,KAAA,GACDC,EAAAD,EAAAlC,EAAAoC,QAAAF,EAAAlC,EAAAqC,IAAArC,EAAAoC,QACFE,OAAEC,QAbHC,UAAAxC,EAAA,GAAAmC,GAgBF,SAASK,KAAAA,GAIR,SAAAC,EAAAJ,EAAAK,GAOGC,EAAMN,GAAOK,IALjBE,GACEC,IACID,EAAM,EACNA,EAAJD,EAAcA,EAAQG,OAAOC,OAAO,OAPpC,IAAMZ,EAAMD,MAAAA,MAAOlC,iEACnBsC,IAAAA,EAAOC,EAAPI,EAAeH,OAAUxC,OAAWmC,MAApCa,EAAAF,OAAAC,OAAA,MAQEJ,OACAC,IAAAA,SAAAA,GACA,YAAiBK,IAAbL,EAAJP,SAAiBY,IAAAD,EAAAX,IAEfW,OAAAA,SAAAX,QACeU,IAAfJ,EAAQG,KACTH,EAAAN,QAAAY,QACFA,IAAAD,EAAAX,KACDW,EAAOX,QAAAY,IAEH3B,IAAA,SAAae,GAFV,IAAAa,EAAAP,EAAAN,GAILc,YAAQF,IAARE,EAAuBD,OACHD,KAAfN,EAAAA,EAAAN,KAEHI,EAAGO,EAAAE,GAPAA,QAKH,GAOAtB,IAAA,SAASqB,EAAAA,QACMZ,IAAfM,EAAQK,GAAiBC,EAAzBZ,GAAoCK,EAClCD,EAAAJ,EAAAK,IAEDU,MAAA,WAhBET,EAAAG,OAAAC,OAAA,MAkBLnB,EAAKkB,OAAUT,OAAKK,o4BA9LxBW,gBAAAC,QAAA,oBACAA,QAAQ,wBACR,IAAMC,SAAWC,IAAI,YACjBC,YACAC,cAAgB,EAChBC,cACAC,GAEJC,MAAMC,OAAOC,IAAb,6XAkCoBC,0BAAlB,SAAAA,EAAYhE,GAAMiE,gBAAAvC,KAAAsC,GAAA,IAAAE,EAAAC,2BAAAzC,MAAAsC,EAAAI,WAAAtB,OAAAuB,eAAAL,IAAAM,KAAA5C,KAAA1B,IAAA,OAEhBkE,EAAKpD,OAALL,MAAKK,EAAQd,MAAAS,QAAAA,MAAA,KACXA,QAAO,IACPQ,gBAFWiD,EAAAlE,MAAAuE,gBAGXA,OAAAA,EAAAA,MAAiBC,OACjBA,QAAQ,GANMN,qBAAA5D,MAAAmE,0DAYhB,OAHDC,QAAAC,IAAAjD,KAAA1B,MAAAK,QAGKqB,KAAK1B,MAAMK,OACNC,MAAAC,cAACR,aAAYK,MAAOsB,KAAKZ,QAEzBR,MAAAC,cAACR,aAAYK,OALhBoE,OAAA,gBAKJhD,SAAOqC,MAAAG,eACRY,MAAA,SAAAC,EAAAC,GACF,IAAAhE,EAAAY,KAAAV,SAOC,OADAF,EAAML,MAAQqE,EAAKrE,MACZK,GAzBiBR,QAAMmE,SA2BbI,EAAQC,GACzB,IAAIhE,EAAQY,KAAKV,SANnB4D,OADIpD,EAAAA,QAAWqC,EAAMG,QACdlD,KAYTe,MAASnB,GA+BP,WACA,IACAqB,EADAE,GAAA,EAEA2B,GAAAlD,IAAAqE,UAAAC,WAEAC,SAAAC,iBAAA,QAAA,SAAAC,GACD,IAAAC,EAAAD,EAAAC,OAS0B,KAAnBA,EAAOC,WAPdpD,GAAY,EACPA,EAAamD,EAAjBE,KACIvD,EAAJqD,EAAAE,KAAAC,QAAA,MAAA,KAUG,GAND,IAAAC,EAAA,YAAAP,SAAAQ,WACAnD,OAAI8C,iBAAA,OAAwB,WAC1BnD,WACAF,WACAE,GAAoBqD,GAErB,KASA,GANHhD,OAAO4C,iBAAiB,WAAQ,SAAYQ,GAC1CC,GACc,YAAAV,SAAAQ,YACVD,EAAAA,iBAFJE,EAAAE,6BAYM3D,GAHJyD,SAAIG,KAAAA,YADN9D,EAGO,GACLE,GAAIA,KAEH,GAtCL,GA2FG,IAAA6D,IAAAC,KAAA,IAzBHC,YA2BDC,MAMGC,GAAI,0BAHJJ,KAAMC,2BACNC,IAAAA,wCACFC,KAAM,wCAGJE,MACAC,GAAAA,8BALaC,KAAA,2BAWbF,IAAK,wCAHPG,KAAM,4CAGJH,OACAC,GAAAA,+BAZaC,KAAA,2BAkBbF,IAAK,kDAHPI,KAAO,wDAILH,YAAAA,EAJKvC,MAAA2C,OAAA,SAAA,SAAA1B,EAAA2B,GAfT,IAAAC,GA0BIC,QAASrE,OAAOsE,eAHhBC,UACEL,gBAAiB,UACjBE,QAAM,GAERI,SAAAA,EACEvC,IAAAA,IACAlE,OAJM0G,YAAA,cAMRC,UAAS,GAEThH,kBAEEiH,EAAAA,EAAAA,MAAUP,EAAA5B,GAFL+B,OARC/B,EAAVA,EAAAkB,aAcAlB,WAAa3E,EAAMuG,MAAK5B,WAAxBA,EAAAkB,mBACSlB,EAATkB,YAGEA,IAAAA,EAAaS,SAAMtG,KAAM6F,MAAAA,KAAYlB,GACrCoC,EA7BK,SAAAC,GA8BN,SAAAD,EAAAlH,GAAAiE,gBAAAvC,KAAAwF,GAAA,IAAAE,EAAAjD,2BAAAzC,MAAAwF,EAAA9C,WAAAtB,OAAAuB,eAAA6C,IAAA5C,KAAA5C,KAKS1B,IADW,GAFfoC,EAAAA,MAAUiF,EAAS/B,MAAKgC,EAAMxG,OAK9BoB,KAAMkF,EAAKpH,MAAMkC,MAAQ,IAJzBgF,QAxBsCE,EAAApH,MAAAoC,SAAAA,EAAAmF,UAAA,OA+BtCC,QAASJ,EAAKpH,MAAMwH,SAAW,UANhBJ,EAAAK,YAAAL,EAAAtG,MAAA0G,QAAA,CAWf,IAAME,EAAcN,EAAKtG,MAAM0G,QATjCJ,EAAKtG,UAAQ2F,WAAYiB,GAAZjB,GACXvE,EAAAA,YAAiBA,WADkBwF,GAClBxF,KACjBE,EAAAA,WAAcpC,WAAL0H,GAAK1H,IACduH,EAAAA,YAHmCvB,WAAA0B,GAAA,KANxC,OAYGN,EAAAO,YAAAP,EAAAO,YAAAC,KAAAR,GAWAA,EAAKS,eAAiBT,EAAKS,eAAeD,KAApBR,GATtBA,EAAIU,SAAAV,EAAWI,SAASI,KAApBR,GAdPA,EA9BM,OAAAW,UAAAb,EAAA7D,gBAAA2E,MAAAC,aAAAf,IAAA7E,IAAA,qBAAAK,MAAA,WAgDDwF,KAAAhB,EAAAiB,UAAA/D,WAAAtB,OAAAuB,eAAA6C,EAAAiB,WAAA,qBAAAzG,MAAA4C,KAAA5C,MACA,IAAA0G,EAAKC,KACNC,EAAA5G,KAAA6G,MAAAjH,MAAAkH,SAWmB9G,KAAK6G,MAAMjH,MAAMmH,YATrCH,EAAwBX,KAAAA,MAALe,QAlBFhH,KAAAiH,GAAA,cAAA,SAAA7D,GAqBlB,IAAA8D,EAAA9D,EAAA+D,KAYSC,EAAQhE,EAAKiE,KA1DmBC,EAAAZ,EAAAN,SAAAc,GAAAR,EAAAT,aAiDxCsB,MAAAD,EAAAC,MACA5G,IAAM+F,EAANS,KACAE,KAAMT,UAKN5G,KAAAiH,GAAKA,aAAG,SAAe7D,GACrB,OAAM8D,EAAAA,WAAN9D,KAeFpD,KAAKwH,KAAK,eAXRd,KAAAA,KAAKT,MAAAA,OACHsB,aAvED5G,IAAA,WAAAK,MAAA,SAiEHyG,GAuBA,IAAMC,OAAA,IAAcD,EAAd,YAAAE,QAAcF,GAXpBG,EAAQ5H,KAAR6G,MAAsBjH,MAAUwD,SAC9B,MAAOsD,UAAPgB,EADFE,EAAAH,GAIU,UAAVC,EACEP,EAAW/H,KAALwI,GADiBT,KAAAM,SAAzB,KAjFG9G,IAAA,cAAAK,MAAA,SASqC1C,GAAA,GAAA0B,KAAAZ,MAAAoB,KAAA,CAAA,IAAAqH,EA8EjCJ,OAAO5G,QAAAzB,MACd0B,WACAyG,MAAMK,EAAAA,MACNjH,IAAI+G,EAAQ/G,IACVwG,KAAA7I,EAAOsJ,IACRP,KAAA/I,EAAA+I,KACD3G,QAAIgH,KAAQtI,MAAUsB,QACpBoH,SAAO/C,EACRgD,SAAA/F,cACFxB,KAAAR,KAAAZ,MAAAoB,YAvFyCM,WA0FxCJ,QAAStB,KAAMoB,MAAME,QACnBF,KAAMqH,KAAAA,MAAAA,OACN/G,GAEEH,IAAAA,EAAWA,SAFHoB,SAAAiG,OAAA,GAGRb,SAAAA,MACAE,MAAAA,EAAM/I,MACNoC,IAAAA,EAAAA,IACAoH,KAAAA,EAAAA,IACAC,KAAAA,EAAAA,KACAvH,SAAMsH,EAREC,SAAV/F,gBAYEtB,mBAjHDC,IAAA,aAAAK,MAAA,WAqHH,IAAA5B,EAAM0I,SAAW/F,MACjBA,IAAAA,EAASkG,OAAK,EACZV,IAAAA,OAAAA,EAiBA,OAhBA5G,KAAKrC,MAAMqC,MACXwG,EAAYxG,GAHAvB,EAAA0I,WAKZA,WACAC,MAAAA,EAAU/F,MANZrB,IAAAuH,EAAAvH,IAsBM0G,KAAMa,EAAWb,KAbvBrF,QAAAA,KAAAA,MAAAA,QACD8F,SAAA,kBAvHyCtH,KAAAR,KAAAZ,MAAAoB,QA2HxC0H,EAAYnG,SAAOoG,MACnBrH,WAAIoH,QAAAA,KAAJ9I,MAAAsB,QAAAF,KAAAR,KAAAZ,MAAAoB,OAAA,IAGE0H,KAxICvH,IAAA,iBAAAK,MAAA,SA2IQkH,EAAAA,GACLb,IAAAA,EAAAA,MAAMa,IACNxH,IAAAA,EAActB,KAALyH,MAAWnG,MAJZ0H,oBAKRN,EAAAA,KAAAA,SAAUO,GACV7H,EAAM8H,KAAA,WANE,GAAAC,EAQX,OAXHhB,MAYOgB,EAAAhB,MACLW,KAAAA,EAAanG,KACbjB,MAAAA,EAAYJ,MACb8H,IAAAD,EAAAC,IAgBKC,OAAQF,EAAKE,OAdnBC,KAAOR,EAAAA,MARK,GAtI4B,IAAAS,EAAA3I,KAAAZ,MAAAuJ,WAkJxC,GAAU,mBAAVC,EAAU,CACV,IAAIR,EAAAA,EAAAA,GACJ,GAAgBhC,gBAAZmC,IAAOM,EAAPN,YAAAA,QAAOM,IAAX,CACAT,GAAAA,EAAAA,SAAwB,OAAAS,EAGlBtB,GADK,mBACEgB,EAAKhB,MADP,OAAAsB,EAAAC,MAAAH,GAELxB,GAFK,mBAEMA,EAFN4B,KAGLC,OAAAA,EAAYA,KAHPL,IAAA,OAAPC,KAhKDjI,IAAA,UAAAK,MAAA,SA0KG2H,GAqBN,IAAMM,EAAKjJ,KAAKZ,MAAM4H,OAflBqB,OAAAA,EAAAa,OAAAA,EAAAC,OAAAA,EACAC,OAAAA,EAAIC,OAAAA,EAIL,GAFGD,EAAApJ,KAAO6I,WAAYF,GAEtB,YAAA3I,KAAAZ,MAAAyG,UAAA,CAMHwC,EAAApG,WAAA+F,OAAA/F,WAAAA,WAAA+F,OAAA,GAAA,GACA,IAAAsB,EAAA9K,EAAA+K,cAAAxH,SAAA,SAAAyH,GAAA,OAAAA,EAAAjC,OAAA0B,IACAK,GAAA,IAiBIA,GAAc,EAflBvH,SAAWA,SAAWiF,MAAtB,EAAAsC,GACArH,WAAIoG,WAAJoB,MAAA,EAAAH,SACAjB,EAAA,QAAArI,KAAIoJ,MAAAA,UAAYC,WAAAA,MAsBRpH,WAAW+F,OAAS/F,WAAWA,WAAW+F,OAAS,GAAK,GAjB9DhI,KAAAZ,MAAA0G,UACA,QAAA9F,KAAAZ,MAAA0G,SAAA1C,EAAAkC,QAIA+C,GAAMpG,EAAAA,KAAW+F,IACjBhI,KAAIsJ,YAAJI,UAAmBH,OAAAA,KAAcxH,WAAUsG,EAAAY,KAAaZ,IAAEc,EAAS5B,IAAF3H,IAAPyI,EAAAY,OACtDK,EAAatJ,KAAImG,eAAAnG,KAAA2J,WAAAtB,EAAAY,MAEnBlH,EAAAA,MAAAA,cAAAA,OAAWA,IAAAA,UAAkBuH,IAAAA,EAA7BM,SAAA,kBAAA9K,UAAA+K,GAAAV,KAPFD,OAAA3H,EACAvB,KAAA+F,YAAAsC,GAAAA,EAAAY,KAAAA,EAAAS,UAAAI,OAAA9J,KAAA2J,WAAAtB,EAAAY,KAAAZ,GAAA,KAaDgB,EAAMrJ,KAAAmG,eAAAiD,EAAAf,GAEN,IAAA0B,EAAAnL,MAAAC,cAAA,OAqBCmL,IAAI,UAnBNrJ,IAAIoE,EAAK3F,SAAM0G,kBACbhH,UAASM,GACP8J,GAgDJ,MA5CM,QAAAlJ,KAAAZ,MAAK2G,WACLoD,WAAAA,MACAF,GAAAA,IAGU7E,IAAAlE,IAAA+I,EAAAI,GAuCZH,GAzBJA,EAAAa,IAEE9H,MArPCtB,IAAA,eAAAK,MAAA,WA0PHoD,GAAAA,KAAA2B,YAAA,CA2BE,IAAMqC,EAAkBpI,KAAK6G,MAAMjH,MAAMwI,gBAzB3CG,EAAAvI,KAAA+F,YAAA+D,OACA,GAAA,mBAAAvB,EAAA,CACA,IAAAM,EAAAN,EAAAH,GACA,GAAA,gBAAA,IAAAS,EAAA,YAAAlB,QAAAkB,KACA,mBAAAA,EAAAoB,MAAA,OAAApB,EAAAoB,aAhQGtJ,IAAA,oBAAAK,MAAA,WAuQH,IAAAkJ,EAAAlK,KAAAkK,UACAC,EAAAnK,KAAAmK,WACA,QAAAnK,KAAAZ,MAAAyG,WAAA,YAAA7F,KAAAZ,MAAAyG,YACAsE,EAAAnK,KAAA2G,YA2BEuD,EAAYlK,KAAKoK,aAxBjB,IAAAC,EAAOrK,KAAW+J,KAAlBA,QADFO,EAEOtK,KAAAuK,KAAArB,QACLmB,IACDA,EAAAG,UAAAxJ,OAAAkJ,GAvQuCI,IAAAA,EAAAE,UAAAxJ,OAAAmJ,GA2QxCnK,KAAAyK,kBApRG9J,IAAA,SAAAK,MAAA,WAwRC,IAAA0J,EAAI7B,KAAAA,MAAcT,YAAlB,eAAApI,KAAA1B,MAAA+G,YAAkB+C,eAClBuC,EAAW9B,KAAPvK,MAAAiH,SAA2B,uBAA3B,QAAAvF,KAAA1B,MAAAwH,QAAA,sBAA2B,SAAA9F,KAAA1B,MAAAwH,QAAA,uBAAA,cAC7B8E,EAAI5K,KAAO6I,aAEdQ,EAAArJ,KAAA6K,QAAAF,GACFG,EAAA3I,MAAA4I,QACFnM,MAAAC,cAAA,OAAAC,UAAA,eAAA8L,GArRyCxH,EAAA4H,eAwRxC,OACApM,MAAAC,cAAA,OAAIsL,UAAAA,GACJvL,MAAAC,cAAAiB,SAASV,EAAMyG,EAAAA,UACbsE,KAAAA,MAAAA,SAAkBxD,MAAAA,cAAAA,EAAAA,MAAlB,GACAuD,OArSC1E,EAAA,GA2SFyF,GACDC,OAAIZ,SAAJnH,EAAgBC,EAAA+H,GACdb,IAAAA,EAAAA,KAAWE,SAEb,OADCpL,EAAAiI,KAAAjE,EAAAiE,KACIoD,GAtSmCW,OAAA,SAAAjI,EAAAC,EAAA+H,GAAA,IAAA/L,EAAAY,KAAAV,SA8TtC2L,OAlBF7L,EAAMwL,OAAAA,EAAU5D,OAGhB5D,EAAM0H,aACJ1L,EAAAuJ,WAAAvF,EAAAuF,YADsBvF,EAEtBA,YAgCAhE,EAAMyG,UAAYzC,EAAKyC,WAAa,QA5BpC,QAAAzG,EAAKyG,WACHsF,EAAA3D,KAAA,eACCL,KAAK/H,EAAMiM,OACXhC,KAAAA,EAAAA,aAmCiB,mBAAXjG,EAAKzD,IA3VwBsE,WAAA,WAAAb,EAAAzD,MAAA,KA8TtCsL,IAASK,EAAAnJ,MAAAqD,EAAAyF,EAAAjG,GAuCfsG,EAAOC,KAAO/M,EAAEoL,SAAS,cAhCvBwB,EAAAA,MAAQlL,IAAA,OAAAoL,EAAAC,MACND,EAAAE,WAkCFC,QAAS,WAGXH,EAAOrE,GAAG,WAAY,SAAS7G,GAAQ,IAhCnCsL,EAAAtL,EAAAsL,QAEEtM,EADOuJ,EAAT9B,MAAqBjH,IAAA,QACAwD,WAGZyC,SAFR6F,EAAA7E,MAAAjH,IAAAC,IAGCT,WAAMyG,WACP/F,SAAA6L,QAAA5M,MAAA,SAkCCkF,WAAW,WAhCT7E,SAAMyG,UAAatG,QAAQ,MAC7B4L,WAAS,WACPhE,SAAM/H,QADgBL,MAAA,MAEtBsI,WAAYsB,WAFd7I,SAAA8L,UAAArM,QAAA,MAIDmM,EAAA7E,MAAA3G,IAAAL,EAAA,aAkCQ,MAhCL,MACFoE,MAAyBb,OAG3BkI,EAAAzE,MAAOzH,QACRgJ,gBAAAkD,IAlCYA,EAsCXA,UACJA,MAAOC,SAAS3B,GAChB,gBAAO/C,IAAM3G,EAAN2G,YAAAA,QAAM3G,KAAb2L,EAAA9M,OACAuM,SAAOE,OAAYK,IAqCjBC,IAAK,WAAuB,IAAdC,EAAcC,UAAAhE,OAAA,QAAAzG,IAAAyK,UAAA,GAAAA,UAAA,GAAN,IAjCxBV,SAAUK,QAAV5M,MAAsB,SAAiBkF,WAAA,WAoCjCnE,SAAS8L,UAAUrM,QAAS,MAlC1B0M,WAAOP,WACP7L,SAAAA,QAAmBd,MAAA,OACnBgB,MAoCDgM,KA/BD9H,SAAAA,GAAAA,WAAW,SAAM4H,GACf/L,OAAAA,EAAAA,SAmPA,OA7NLwL,EALexG,QAMhBgH,aAAK,SAAuBrE,GAAA,IAAdsE,EAAc/L,KAAA6G,MAAAjH,MAAAkH,SAqC1B,OAAO/B,EAAMmH,KAAKtE,GAAaT,KAAMM,KAnCrCxD,WAAAA,SAAW7D,GACTN,OAAAA,UAEEA,WAAAA,SAAgBqM,GADlBA,IAFFpK,SAAAoK,EAAAtL,SAAAkB,SAMDE,WAAAkK,EAAAC,OAAAnK,aAGHJ,aAAY,SAAYzB,GACtB2B,YAsCEE,eAnCFoK,MAAA,SAAApD,EAAA5B,GACArH,KAAAsM,aACAtM,KAAAuM,KAAAtD,EAAA5B,GAEArH,KAAAwM,QAAAxM,KAAAwM,OAAAlO,QACA0B,KAAAwM,OAAAlO,MAAA0I,OAAAiC,EACAjJ,KAAAwM,OAAAlO,MAAAqK,WAAAtB,IAIAoF,OAAA,WACA,IAAAC,OAAAA,EAfF,GAAA1M,KAAA2M,cAsDMD,EAAW1M,KAAK2M,YApClBC,EAAS3H,QAAAyH,IAEL,OADA1H,EADKC,QAAA4H,WAAAH,IAEL,GAINI,KAAAA,SAAcC,EAAA3M,GACZ,IAAMwH,OAAAA,EACN,GAAAmF,EAAOhI,CAHG2H,EAAAK,EAKAC,KAAAC,UAAAlL,UACViL,KAAAC,UAAAhL,YADFiL,IALYC,EAAApL,SAAAA,SAAAiG,OAAA,GASNmE,GACFpK,KAAAA,OAAWoK,SACXlK,QAAAA,SACDmK,MAAAnK,WAZSmL,QAAAD,GAeVpL,KAAAA,YAAA2K,EACAzK,EAAAA,QAAaoL,QAAbX,EAAAM,KAAAC,UAAAK,MAGAC,QAAI,SAAKjB,EAAclM,GACrB,IAAAsM,OAAAA,EACD,GAFDK,IAIIL,EAAKF,EACLxH,EAAKwH,QAAOlO,IAAMqK,CACnB,IAAA2E,EAAAN,KAAAQ,MAAAxI,EAAAC,QAAAyH,IAGLD,GAFGzH,EAAAC,QAAA4H,WAAAH,GAEKY,EAAAzM,QAAYmH,OAAA,CACd0E,IAAAA,GACAe,KAAKd,EAAa9L,QAAAsH,MACpBuE,MAAWY,EAAKX,MAAhBxE,OAaMgF,OAVJpL,SAAAuL,EAAAzM,QACDoB,WAAAqL,EAAAlB,MAICM,KAAAA,MACJS,EAAUM,KAAAtG,KACRuF,EAAAA,KAAArF,OAGYtF,KAMVqL,KAAAA,SAASD,EAAAA,GAAAA,IAAAA,EAAAA,KAJMlN,KAAjB2C,KAAA5C,KAAA,SAAA0N,GAMAzJ,WAAK0I,WACL3H,KACDG,OAAAwI,KAEHJ,IAASK,EAAAC,EAAgBzN,KAAQ,eAC3BsM,QACAK,QAAMhL,UAGR8J,OACE1E,KAAMmG,EACNtI,KAAIC,GAGF6I,WAAUD,EAAAC,aAER1B,EAAAA,IAAAA,eAuCN,IAAM2B,EAAmBF,EAAKrG,KAAK,cApC/BzF,QACAE,QAAAA,UAIA4J,OAsCA1E,KAAMM,EAjCNJ,KAAAA,GAGLyG,WAAAD,EAAAC,aAGHvB,IAAMqB,IAAuBG,GACX,iBAANtG,EAAVxH,CACEgE,IAAAA,EAAW4J,EAAAf,aAAMrF,GACfiG,GADFG,EAEG1I,SAqCC6B,OAAQtD,EAAO6D,MAnCbqG,WAAAA,EACJzB,UAAQ,aAMN9E,KAAAA,SAAMA,EAAAA,GAAAA,IAAAA,EAAAA,KAFDpH,KAL0C2C,KAAA5C,KAAA,SAAA0N,GA6CnDzJ,WAAW,WAnCT6J,KAVF3I,OAAAwI,KAiDA,IAAMK,EAAoBC,EAAKzG,KAAK,eAnCpC2E,QACEA,QAAQpK,UAAA8J,OAwCN1E,KAAMM,EAnCRoE,KAAOxE,GAELA,WAAMA,EAAAA,aAGRyG,EAAAA,IAAAA,eAsCF,IAAMI,EAAmBD,EAAKzG,KAAK,cAnCnC2E,QACI4B,QAAAA,UAGJlC,OACInI,KAAJ+D,EACEJ,KAAK8G,GAEHxF,WAAAA,EAAYtB,aAGf,IAAA2G,IA5CHE,EAAA,CAmFE,IAAI1C,KAnCR9G,GAAMuJ,EAAAG,MAAA,WAAA,CAAuB,IAAAC,EAAAtM,SAAAA,SAAAiG,OAAA,GAsCjBsG,GArCL1L,MAAKyL,EAAV9G,MACEtD,KAAAA,EAAWkD,KACTuG,KAAAA,EAAAA,KACCvI,IAAAA,EAAOwI,SAuCNnN,KAAM6N,EAAE7N,MAnCRK,KADFsL,EAAQ8B,EAAAzG,KAAA,UAAA8G,IACGvM,OADH,GADyC0F,EAAA,CAKjDoE,GAAO,iBAAApE,EAAA,OACLN,IAAAA,EADK8G,EAAAnB,aAAArF,GAELJ,GAP+C4G,EAAAE,SASjDL,OAAYpK,EAAKoK,MATnBnF,WAAA5D,EAAAtG,SAAA4I,EAAAmE,GAiDM3F,UAAW,iBAnCXqI,CACJ/B,IAAAA,EAAQ8B,EAAAzG,KAAA,cAgDR,GAAI+G,EAhCJ,OALEP,EAAAA,SACAE,OAAAA,EAAkB3G,MAuChBoB,WAAY5D,EAAMtG,SAAU8P,EAAUlH,KAAMmE,GArC9CA,UAAY,SAEJzJ,EAERwF,OAASA,QADMS,OAEfb,QAAQA,OAERkB,WAAOP,QAJQpH,IAAA,UAYjB4K","file":"../index.js","sourcesContent":["import { Tabs } from 'aotoo-react-tabs'\nrequire('aotoo-mixins-iscroll')\nconst Popstate = SAX('Popstate');\nvar _history = []\nvar _historyCount = 0\nvar _leftStack = []\nvar os\n\nAotoo.inject.css(`\n  .progress-slot {\n    width: 100%;\n    height: 2px;\n    padding: 0;\n    margin: 0;\n    position: absolute;\n    top: 0;\n    left: 0;\n    z-index: 999;\n  }\n\n  .progress-stat {\n    background-color: #ccc;\n    width: 0;\n    height: 2px;\n    padding: 0;\n    margin: 0;\n    -webkit-transition: all .2s ease-in-out;\n    transition: all .2s ease-in-out;\n  }\n`)\n\nfunction ProgressFun(props) {\n  let _props = _.merge({}, props)\n  if (_props.style && _props.style.enable) delete _props.style.enable\n  return (\n    <div className=\"progress-slot\">\n      <div className=\"progress-stat\" style={_props.style||{width: '0'}}></div>\n    </div>\n  )\n}\n\nclass ProgressClass extends React.Component {\n  constructor(props){\n    super(props)\n    this.state = {\n      width: this.props.width || {width: '0'},\n      opacity: '1',\n      backgroundColor: this.props.backgroundColor,\n      height: this.props.height,\n      enable: true\n    }\n  }\n  render(){\n    console.log(this.props.enable);\n    if (this.props.enable) {\n      return <ProgressFun style={this.state}/>\n    } else {\n      return <ProgressFun style={{height: '0'}}/>\n    }\n  }\n}\n\nconst Progress = Aotoo(ProgressClass, {\n  WIDTH: function(ostate, opts) {\n    let state = this.curState\n    state.width = opts.width\n    return state\n  },\n  OPACITY: function (ostate, opts) {\n    let state = this.curState\n    state.opacity = opts.opacity\n    return state\n  }\n})\n\nfunction _os(ua) {\n  var ret = {},\n    android = ua.match(/(?:Android);?[\\s\\/]+([\\d.]+)?/),\n    ios = ua.match(/(?:iPad|iPod|iPhone).*OS\\s([\\d_]+)/);\n  ret.mobile = !!(android || ios)\n  return ret;\n}\n\nlet stat = true\nfunction once(cb) {\n  const id = this.saxer.get('__id')\n  const operateId = id + '_OPERATE'\n  const operate = this.saxer.get(operateId)\n  Progress.$width({width: \"70%\"})\n  if (operate) {\n    if (operate == 'break') return   // continue will dealwith flow code\n    else {\n      this.saxer.set(operateId, 'break')\n    }\n  } else {\n    this.saxer.set(operateId, 'break')\n  }\n  function next(params) {\n    stat = true\n  }\n  if (stat) {\n    stat = false\n    cb(next)\n  }\n\n  // clearTimeout(mytimmer)\n  // mytimmer = setTimeout(() => {\n  //   if (stat) {\n  //     stat = false\n  //     cb(next)\n  //   }\n  // }, delay);\n}\n\n(function () {\n  var anchorHash = false\n  var anchorHref\n  os = _os(navigator.userAgent)\n\n  document.addEventListener('click', function (e) {\n    var target = e.target\n    if (target.nodeName == 'A') {\n      anchorHash = false\n      anchorHref = target.href\n      anchorHash = target.href.indexOf('#') > -1 ? true : false\n    }\n  }, false)\n\n  var blockPopstateEvent = document.readyState != \"complete\";\n  window.addEventListener(\"load\", function () {\n    setTimeout(\n      function () {\n        blockPopstateEvent = false;\n      },\n      0)\n  }, false)\n\n  window.addEventListener(\"popstate\", function (evt) {\n    if (blockPopstateEvent && document.readyState == \"complete\") {\n      evt.preventDefault()\n      evt.stopImmediatePropagation()\n    } else {\n      if (anchorHash) {\n        /* do something */\n      } else {\n        Popstate.emit('__goback');\n      }\n      anchorHref = ''\n      anchorHash = false\n    }\n  }, false)\n}())\n\nfunction pushState(props, nohash) {\n  const flag = props.flag ? (typeof props.flag == 'boolean' ? '#' : props.flag) : ''\n  const uri = flag ? props.rootUrl + flag + props.key : props.rootUrl\n  window.history.pushState(props, '', uri)\n}\n\nfunction _lru(max) {\n  //https://github.com/dominictarr/hashlru\n  if (!max) throw Error('hashlru must have a max value, of type number, greater than 0')\n  var size = 0, cache = Object.create(null), _cache = Object.create(null)\n  function update(key, value) {\n    cache[key] = value\n    size++\n    if (size >= max) {\n      size = 0\n      _cache = cache\n      cache = Object.create(null)\n    }\n  }\n  return {\n    has: function (key) {\n      return cache[key] !== undefined || _cache[key] !== undefined\n    },\n    remove: function (key) {\n      if(cache[key] !== undefined)\n        cache[key] = undefined\n      if(_cache[key] !== undefined)\n        _cache[key] = undefined\n    },\n    get: function (key) {\n      var v = cache[key]\n      if(v !== undefined) return v\n      if((v = _cache[key]) !== undefined) {\n        update(key, v)\n        return v\n      }\n    },\n    set: function (key, value) {\n      if(cache[key] !== undefined) cache[key] = value\n      else update(key, value)\n    },\n    clear: function () {\n      cache = Object.create(null)\n      _cache = Object.create(null)\n    }\n  }\n}\n\n\nlet lru = _lru(50)\nlet animatecss = {\n  fade: {\n    in: ' fadeIn animated-faster',\n    rein: ' fadeIn animated-fastest',\n    out: ' fadeOut contentHide animated-fastest',\n    back: ' fadeOut contentHide animated-faster'\n  },\n\n  left: {\n    in: ' fadeInLeft animated-faster',\n    rein: ' fadeIn animated-fastest',\n    out: ' fadeOut contentHide animated-fastest',\n    back: ' fadeOutLeft contentHide animated-faster'\n  },\n\n  right: {\n    in: ' fadeInRight animated-faster',\n    rein: ' fadeIn animated-fastest',\n    out: ' outHeight fadeOut contentHide animated-fastest',\n    back: ' outHeight fadeOutRight contentHide animated-faster',\n  }\n}\n\nlet __opts\nAotoo.extend('router', function (opts, utile) {\n  let dft = {\n    storage: window.sessionStorage,\n    progress: {\n      backgroundColor: '#108ee9',\n      enable: true\n    },\n    likeApp: false,   // 模仿app动画切换，保持2个页面, 置为false 可暂时停止prepage页面，提升性能\n    gap: 100,   // 两次点击之间的间隙延时时间，防止click多次响应\n    props: {\n      routerClass: 'routerGroup',\n      mulitple: false\n    },\n    iscrollConfig: {}  // 导航栏的iscroll滚动参数设置\n  }\n  opts = utile.merge(dft, opts)\n  __opts = opts\n\n  if (opts.animatecss) {\n    animatecss = utile.merge(animatecss, opts.animatecss)\n    delete opts.animatecss\n  }\n\n  const rootUrl = location.href.split('#')[0]\n  class Router extends Tabs {\n    constructor(props) {\n      super(props)\n      this.state = utile.merge(this.state, {\n        flag: this.props.flag || '#',\n        rootUrl: this.props.rootUrl || rootUrl,\n        direction: 'goto',\n        animate: this.props.animate || 'right'\n      })\n      this.prePageInfo\n\n      if (this.state.animate) {\n        const animateType = this.state.animate  // fade, left, right\n        this.animatein = animatecss[animateType]['in']\n        this.animaterein = animatecss[animateType]['rein']\n        this.animateout = animatecss[animateType]['out']\n        this.animateback = animatecss[animateType]['back']\n      }\n\n      this.historyPush = this.historyPush.bind(this)\n      this.getRealContent = this.getRealContent.bind(this)\n      this.findPath = this.findPath.bind(this)\n    }\n\n    componentWillMount() {\n      super.componentWillMount()\n      const that = this\n      const menuData = this.saxer.get().MenuData\n      const contentData = this.saxer.get().ContentData\n      const selectItem = menuData[this.state.select]\n\n\n      this.on('historypush', function (opts) {\n        const _path = opts.path\n        const _data = opts.data\n        const historyItem = that.findPath(_path)\n\n        that.historyPush({\n          index: historyItem.index,\n          key: historyItem.path,\n          data: _data || {}\n        })\n      })\n\n      this.on('historypop', function (opts) {\n        return that.historyPop(opts)\n      })\n\n      this.emit('historypush', {\n        path: this.state.select,\n        data: {}\n      })\n    }\n\n    findPath(where) {\n      const type = typeof where\n      const menu_data = this.saxer.get().MenuData\n      if (type == 'number') {\n        return menu_data[where]\n      }\n      if (type == 'string') {\n        return utile.find(menu_data, { path: where })\n      }\n    }\n\n    historyPush(props) {\n      if (this.state.flag) {\n        const curHistoryState = window.history.state\n        pushState({\n          index: props.index,\n          key: props.key,\n          path: props.key,\n          data: props.data,\n          rootUrl: this.state.rootUrl,\n          preState: curHistoryState,\n          timeLine: _historyCount,\n          flag: this.state.flag\n        })\n      } else {\n        pushState({\n          rootUrl: this.state.rootUrl,\n          flag: this.state.flag\n        }, true)\n      }\n      const preState = _history[_history.length - 1]\n      _history.push({\n        index: props.index,\n        key: props.key,\n        path: props.key,\n        data: props.data,\n        preState: preState,\n        timeLine: _historyCount\n      })\n\n      _historyCount++\n    }\n\n    historyPop() {\n      let state = _history.pop()\n      if (!state) return false\n      let rightState;\n      if (this.state.flag) {\n        rightState = (state && state.preState)\n        if (rightState) {\n          pushState({\n            index: rightState.index,\n            key: rightState.key,\n            data: rightState.data,\n            rootUrl: this.state.rootUrl,\n            preState: \"curHistoryState\",\n            flag: this.state.flag\n          })\n        }\n      } else {\n        rightState = _history.pop()\n        pushState({ rootUrl: this.state.rootUrl, flag: this.state.flag }, true)\n      }\n\n      return rightState\n    }\n\n    getRealContent(cnt, pre) {\n      if (!cnt) return ' '\n      let InstanceContext = this.saxer.get().InstanceContext || {}\n      let _pre = this.findPath(pre)\n      InstanceContext.from = (function () {\n        if (_pre) {\n          return {\n            index: _pre.index,\n            path: _pre.path,\n            title: _pre.title,\n            idf: _pre.idf,\n            parent: _pre.parent,\n            attr: _pre.attr\n          }\n        }\n      })()\n      const selectData = this.state.selectData\n      if (typeof cnt == 'function') {\n        let result = cnt(InstanceContext)\n        if (typeof result == 'object') {\n          if (result['$$typeof']) return result\n\n          // enter, leave, main, loaded\n          if (typeof result.enter == 'function') return result.enter(selectData)\n          else if (typeof result.main == 'function') {\n            return result.main(selectData)\n          }\n        }\n      }\n      return cnt\n    }\n\n    getPage(boxCls) {\n      // const xxid = this.saxer.get('__id')\n      // const operateId = xxid + '_OPERATE'\n      // const operate = this.saxer.get(operateId)\n\n      const id = this.state.select;\n      let pre, preId, prePage, preContent;\n      let oriContent, content;\n      oriContent = this.getContent(id);\n\n      if (this.state.direction == 'jumpback') {\n        // content = lru.get(id)\n        // if (!content) {\n        //   oriContent = this.getContent(id)\n        //   content = this.getRealContent(oriContent)\n        // }\n\n        pre = _leftStack.length ? _leftStack[_leftStack.length - 1] : '';\n        let rightIndex = _.findLastIndex(_history, function (o) { return o.index == id })\n        if (rightIndex > -1) {\n          rightIndex += 1\n          _history = _history.slice(0, rightIndex)\n          _leftStack = _leftStack.slice(0, (rightIndex))\n        }\n      }\n      else\n      if (this.state.direction == 'back') {\n        pre = _leftStack.pop()\n      } else {\n        pre = _leftStack.length ? _leftStack[_leftStack.length - 1] : '';\n      }\n\n      if (this.state.animate) {\n        if (this.state.animate == 'fade' || !opts.likeApp) {\n          prePage = undefined\n          this.prePageInfo = (pre && pre.id !== id) ? { origin: this.getContent(pre.id), ...pre} : ''\n        } else {\n          if (pre && pre.id !== id) {\n            this.prePageInfo = { origin: this.getContent(pre.id), ...pre}\n            preContent = lru.get(pre.id)\n            if (!preContent) {\n              preContent = this.getRealContent(this.getContent(pre.id))\n            }\n            prePage = <div ref='prePage' key={utile.uniqueId('Router_Single_')} className={boxCls}>{preContent}</div>\n          }\n        }\n      }\n\n      content = this.getRealContent(oriContent, pre)\n\n      const curPage = <div\n        ref=\"curPage\"\n        key={utile.uniqueId('Router_Single_')}\n        className={boxCls}>\n        {content}\n      </div>\n\n      // 下面的部分有顺序要求，不能随意放置\n      if (this.state.direction == 'goto') {\n        _leftStack.push({\n          id: id,\n        })\n      }\n\n      lru.set(id, content)\n\n      // if (operate == 'break') {\n      //   setTimeout(() => {\n      //     Progress.$width({width: \"100%\"})\n      //     setTimeout(() => {\n      //       Progress.$opacity({opacity: \"0\"})\n      //       setTimeout(() => {\n      //         Progress.$width({width: \"0\"})\n      //         setTimeout(() => {\n      //           Progress.$opacity({opacity: \"1\"})\n      //         }, 200);\n      //       }, 400);\n      //     }, 500);\n      //   }, 1000);\n      //   this.saxer.set(operateId, 'continue')\n      // }\n\n      if (prePage) {\n        return [ prePage, curPage ]\n      } else {\n        return [ curPage ]\n      }\n    }\n\n    leaveContent() {\n      if (this.prePageInfo) {\n        const InstanceContext = this.saxer.get().InstanceContext\n        const _pre = this.prePageInfo.origin\n        if (typeof _pre == 'function') {\n          let result = _pre(InstanceContext)\n          if (typeof result == 'object') {\n            if (typeof result.leave == 'function') return result.leave()\n          }\n        }\n      }\n    }\n\n    componentDidMount() {\n      let animatein = this.animatein\n      let animateout = this.animateout\n      if (this.state.direction == 'back' || this.state.direction == 'jumpback') {\n        animateout = this.animateback\n        animatein = this.animaterein\n      }\n      const curPageDom = this.refs.curPage\n      const prePageDom = this.refs.prePage\n      if (curPageDom) {\n        curPageDom.classList.value += animatein\n      }\n      if (prePageDom) {\n        prePageDom.classList.value += animateout\n      }\n      this.leaveContent()\n    }\n\n    render() {\n      const cls = !this.props.routerClass ? 'routerGroup ' : 'routerGroup ' + this.props.routerClass\n      const boxes_cls = !this.props.mulitple ? (this.props.animate == 'left' ? 'routerBoxes boxLeft' : this.props.animate == 'right' ? 'routerBoxes boxRight' : 'routerBoxes') : 'routerBoxes mulitple'\n      const jsxMenu = this.createMenu()\n\n      const content = this.getPage(boxes_cls)\n      const IscrollTreeMenu = Aotoo.iscroll(\n        <div className='routerMenus'>{jsxMenu}</div>, \n        opts.iscrollConfig\n      )\n\n      return (\n        <div className={cls}>\n          <Progress.x {...opts.progress}/>\n          {this.state.showMenu ? <IscrollTreeMenu /> : ''}\n          {content}\n        </div>\n      )\n    }\n  }\n\n  const Action = {\n    UPDATE: function (ostate, opts, ctx) {\n      let state = this.curState\n      state.data = opts.data\n      return state\n    },\n\n    SELECT: function (ostate, opts, ctx) {\n      let state = this.curState\n\n      // select\n      state.select = opts.select\n\n      // selectData\n      if (opts.selectData) {\n        state.selectData = opts.selectData\n      }\n\n      if (opts.direction) {\n        state.direction = opts.direction || 'goto'\n      }\n\n      if (state.direction == 'goto') {\n        ctx.emit('historypush', {\n          path: state.select,\n          data: state.selectData\n        })\n      }\n\n      if (typeof opts.cb == 'function') {\n        setTimeout(function () { opts.cb() }, 100);\n      }\n\n      return state\n    },\n  }\n\n  // const router = Aotoo(Tabs, Action, dft)\n  let router = Aotoo(Router, Action, dft)\n  router.__id = _.uniqueId('ROUTER_ID_')\n  router.saxer.set('__id', router.__id)\n  router.condition = {\n    preback: 'preback'\n  }\n  \n  router.on('rendered', function(params) {\n    const {context} = params\n    const xxid = context.saxer.get('__id')\n    const operateId = xxid + '_OPERATE'\n    const operate = context.saxer.get(operateId)\n\n    if (operate == 'break') {\n      setTimeout(() => {\n        Progress.$width({width: \"100%\"})\n        setTimeout(() => {\n          Progress.$opacity({opacity: \"0\"})\n          setTimeout(() => {\n            Progress.$width({width: \"0\"})\n            setTimeout(() => {\n              Progress.$opacity({opacity: \"1\"})\n              context.saxer.set(operateId, 'continue')\n            }, 200);\n          }, 100);\n        }, 100);\n      }, 500);\n    }\n  })\n\n  router.saxer.append({\n    InstanceContext: router\n  })\n\n  router.progress = {\n    start: function(param) {\n      if (typeof param == 'object' && param.width) {\n        Progress.$width(param)\n      }\n    },\n    end: function(timeout=1000) {\n      Progress.$width({width: \"100%\"})\n      setTimeout(() => {\n        Progress.$opacity({opacity: \"0\"})\n        setTimeout(() => {\n          Progress.$width({width: \"0\"})\n        }, 300);\n      }, timeout);\n    }\n  }\n\n  Popstate.on('__goback', function (param) {\n    return router.back()\n\n    // let hash\n    // if (param.href.indexOf('#')>-1) {\n    //   hash = param.href.substr(param.href.indexOf('#')+1)\n    // }\n    // // if (!hash) {\n    // //   return router.back()\n    // // }\n    // if (hash) {\n    //   const lastItem = _history[(_history.length - 1)]\n    //   if (hash !== lastItem.path) {\n    //     return router.back()\n    //   }\n    // }\n  })\n\n  let timmer = {\n    goto: '',\n    back: ''\n  }\n\n  router.extend({\n    getWhereInfo: function (where) {\n      const menu_data = this.saxer.get().MenuData\n      return utile.find(menu_data, { path: where })\n    },\n    getHistory: function (params) {\n      return _history\n    },\n    setHistory: function (record) {\n      if (record) {\n        _history = record.history || _history\n        _leftStack = record.stack || _leftStack\n      }\n    },\n    clearHistory: function (params) {\n      _history = []\n      _leftStack = []\n    },\n    start: function (id, data) {\n      if (this.hasMounted()) {\n        this.goto(id, data)\n      } else {\n        if (this.config && this.config.props) {\n          this.config.props.select = id\n          this.config.props.selectData = data\n        }\n      }\n    },\n    delete: function () {\n      let sessName\n      if (this.storageName) {\n        sessName = this.storageName\n        if (dft.storage[sessName]) {\n          dft.storage.removeItem(sessName)\n          return true\n        }\n      }\n    },\n    save: function (name, params) {\n      let sessName\n      if (name) {\n        sessName = name\n        const his = JSON.stringify(_history)\n        const stack = JSON.stringify(_leftStack)\n        const cur = _history[_history.length - 1]\n\n        const sessData = {\n          from: window.location,\n          history: _history,\n          stack: _leftStack,\n          current: cur\n        }\n        this.storageName = sessName\n        dft.storage.setItem(sessName, JSON.stringify(sessData))\n      }\n    },\n    restore: function (name, params) {\n      let sessName\n      if (name) {\n        // sessName = name + '_' + this.globalName\n        sessName = name\n        if (dft.storage[sessName]) {\n          const sessData = JSON.parse(dft.storage[sessName])\n          dft.storage.removeItem(sessName)\n\n          if (sessData.history.length) {\n            var cur = {\n              page: sessData.history.pop(),\n              stack: sessData.stack.pop()\n            }\n\n            _history = sessData.history\n            _leftStack = sessData.stack\n\n            // _history.pop()\n            // _leftStack.pop()\n            this.start(\n              cur.page.path,\n              cur.page.data\n            )\n  \n            return true\n          }\n        }\n      }\n    },\n\n    goto: function (where, data) {\n      once.call(this, next => {\n        setTimeout(() => {\n          next()\n        }, __opts.gap);\n\n        const result_beforegoto = this.emit('_beforeGoto', {\n          record: {\n            history: _history,\n            // stack: _leftStack,\n          },\n          param: {\n            path: where,\n            data: data\n          },\n\n          setHistory: this.setHistory\n        })\n        this.off('_beforeGoto')\n\n        const resultBeforegoto = this.emit('beforeGoto', {\n          record: {\n            history: _history,\n            // stack: _leftStack,\n          },\n\n          param: {\n            path: where,\n            data: data\n          },\n\n          setHistory: this.setHistory\n        })\n\n        if (result_beforegoto) return\n        if (resultBeforegoto) return\n\n        if (typeof where != 'string') return\n        const target = this.getWhereInfo(where)\n        if (target) {\n          this.$select({\n            select: target.index,\n            selectData: data,\n            direction: 'goto'\n          })\n        }\n      })\n    },\n\n    back: function (where, data) {\n      once.call(this, next => {\n        setTimeout(() => {\n          next()\n        }, __opts.gap);\n        \n        const result_beforeback = this.emit('_beforeBack', {\n          record: {\n            history: _history,\n            // stack: _leftStack,\n          },\n          param: {\n            path: where,\n            data: data\n          },\n          setHistory: this.setHistory\n        })\n  \n        this.off('_beforeBack')\n  \n        const resultBeforeback = this.emit('beforeBack', {\n          record: {\n            history: _history,\n            // stack: _leftStack,\n          },\n          param: {\n            path: where,\n            data: data\n          },\n          setHistory: this.setHistory\n        })\n  \n        if (result_beforeback) return\n        if (resultBeforeback) return\n  \n        let condition = {}\n        if (this.hasOn('preback')) {\n          const h = _history[_history.length - 1]\n          const whereami = {\n            index: h.index,\n            path: h.path,\n            data: h.data,\n            pre: h.preState,\n            flag: h.flag\n          }\n          condition = this.emit('preback', whereami)\n          if (!condition) return\n        }\n        if (where) {\n          if (typeof where != 'string') return\n          const target = this.getWhereInfo(where)\n          if (target) {\n            this.$select({\n              select: target.index,\n              selectData: utile.merge({}, data, condition),\n              direction: 'jumpback'\n            })\n          }\n        } else {\n          const whereBack = this.emit('historypop')\n          // whereBack: {\n          // index: props.index,\n          // key: props.key,\n          // data: props.data,\n          // rootUrl: this.state.rootUrl,\n          // preState: curHistoryState,\n          // timeLine: _historyCount,\n          // flag: this.state.flag\n          //}\n          if (whereBack) {\n            this.$select({\n              select: whereBack.index,\n              selectData: utile.merge({}, whereBack.data, condition),\n              direction: 'back'\n            })\n            return whereBack\n          } else {\n            if (window.history.length) {\n              history.back()\n            } else {\n              pushState({ rootUrl: rootUrl }, true)\n            }\n          }\n        }\n      })\n    }\n  })\n\n  return router\n})"]}