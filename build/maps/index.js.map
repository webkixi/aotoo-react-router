{"version":3,"sources":["index.js"],"names":["ProgressFun","props","_props","_","merge","style","enable","ProgressClass","React","createElement","className","width","state","android","match","ios","ua","ret","mobile","once","cb","_this2","this","stat","operateId","params","saxer","get","operate","Progress","$width","set","setTimeout","next","_pushState","nohash","flag","init","instProps","config","rawurl","cleanUri","rootUrl","key","toggleUrl","location","href","query","isPlainObject","data","datas","Object","keys","length","completeUri","window","Aotoo","uri","history","pushState","replaceState","_lru","max","update","value","cache","size","create","Error","_cache","undefined","v","remove","clear","_aotooReactTabs","require","Popstate","SAX","_history","_historyCount","_leftStack","_restoreStat","os","_classCallCheck","_this","_possibleConstructorReturn","__proto__","getPrototypeOf","call","opacity","backgroundColor","height","Component","WIDTH","ostate","opts","curState","OPACITY","anchorHref","anchorHash","_os","navigator","userAgent","document","addEventListener","e","target","nodeName","indexOf","blockPopstateEvent","readyState","evt","stopImmediatePropagation","preventDefault","lru","animatecss","fade","in","out","back","rein","left","right","extend","utile","dft","storage","sessionStorage","__opts","progress","likeApp","gap","mulitple","Router","_Tabs","_this3","split","direction","animate","prePageInfo","animateType","historyPush","bind","getRealContent","findPath","_inherits","Tabs","_createClass","_get","prototype","that","animateback","menuData","MenuData","ContentData","select","on","_path","path","_data","historyItem","index","contentData","selectItem","search","substring","historyPop","item","parts","where","type","_typeof","menu_data","selectData","find","curHref","preState","curHistoryState","timeLine","preHref","rightState","rightHref","pop","cnt","pre","InstanceContext","from","_pre","title","idf","parent","attr","result","enter","main","boxCls","id","oriContent","content","getContent","rightIndex","findLastIndex","o","preId","slice","prePage","_extends","origin","preContent","ref","uniqueId","curPage","leave","animatein","animateout","animaterein","curPageDom","refs","prePageDom","classList","leaveContent","cls","routerClass","boxes_cls","jsxMenu","createMenu","getPage","IscrollTreeMenu","iscroll","treeHeader","treeFooter","x","Action","UPDATE","ctx","SELECT","emit","showMenu","router","__id","condition","context","$opacity","param","end","timeout","arguments","xxid","lastItem","getWhereInfo","getHistory","setHistory","record","stack","clearHistory","timmer","hasMounted","goto","delete","storageName","sessName","name","JSON","stringify","cur","current","setItem","sessData","restore","parse","removeItem","page","start","_this4","resultBeforegoto","result_beforegoto","$select","_this5","result_beforeback","off","resultBeforeback","hasOn","h","whereami","whereBack"],"mappings":"wnBAsDM,SAAAA,YAAAC,GADF,IADFC,EAAAC,EAAAC,SAAAH,GAAA,OAKDC,EAAAG,OAAAH,EAAAG,MAAAC,eAAAJ,EAAAG,MAAAC,OAEKC,MAAAA,cAAAA,OAAAA,UANa,iBACbC,MAAAC,cAAA,OAAKC,UAAU,gBAAgBL,MAAOH,EAAOG,QAAQM,MAAO,QAgC9D,SAAIC,IAAAA,GACJA,IAAAA,KACAC,EAAOD,EAAPE,MAAA,iCACDC,EAAAC,EAAAF,MAAA,sCAQD,OAlBFG,EAAAC,UAAAL,IAAAE,GAkBSE,EAJP,SAEEF,KAAMC,GACRC,MAAIC,EAEL,SAAAC,KAAAC,GAAA,IAAAC,EAAAC,KAOC,GAAIC,KAAM,CALRA,MAAO,EACX,IACSC,EADKC,KAAdC,MAAsBC,IAAA,QACpB,WACDC,EAAAN,KAAAI,MAAAC,IAAAH,GACiB,GAAlBK,SAAAC,QAAkBnB,MAAA,QAAAiB,EAAA,CAQZ,GAAe,SAAXA,EAAoB,OAN1BL,KAAOG,MAAPK,IAAAP,EAAA,cAGAF,KAAMM,MAAAA,IAAUJ,EAAA,SAEhBQ,WAAA,WACEX,EAAIO,MAAAA,IAAWJ,EAAS,YAAxBD,MACK,GACH,KACDH,EAAAa,OAwEL,SAAAC,WAAAjC,EAAAkC,GACA,IAAAC,EAAAnC,EAAAmC,KAAA,kBAAAnC,EAAAmC,KAAA,IAAAnC,EAAAmC,KAAA,GACAC,EAAApC,EAAAoC,KACAC,EAAArC,EAAAsC,OAAAtC,iBAvDFA,EAAAsC,OA0DA,IAAAC,EAASN,EAAWjC,WACZmC,EAAaA,OACbC,EAAaA,OASbI,EAAWL,EAAOnC,EAAMyC,QAAUN,EAAOnC,EAAM0C,IAAM1C,EAAMyC,QAL3DF,EAAeI,EAAAA,OAAaC,SAAIC,KAAA,WACpC,IAAAC,EAAQT,GADuB,GAE1BA,EAAAA,MAAUE,MAFjBQ,cAAA/C,EAAAgD,MAAA,CASI,IAAMC,EAAQC,OAAOC,KAAKnD,EAAMgD,MALpCC,EAAAG,SACMZ,EAAAA,IACAa,EAAAA,QAAcjB,SAAAA,EAAOkB,GACrBR,EAAQG,EAAZG,SACUJ,EAAN,GAAcO,EAAMR,OAChBE,GAAQC,EAAOC,IAAKnD,EAAMgD,KAAhCN,GAEEI,GAAAJ,EAAA,IAAA1C,EAAAgD,KAAAN,GAAA,QAMMI,OAAAA,EAAAA,EAjB0B,GAmB7BU,EAAAjB,EAAAc,EAAAb,EAEJJ,EACFG,GAAAe,OAAAG,QAAAC,UAAA1D,EAAA,GAAAwD,GAhB+CF,OAAlDG,QAAAC,UAAA1D,EAAA,GAAAwD,GAsBE,SAAKjB,UAAQe,EAAOG,GACrB,GAFDzD,EAGEsD,GAAAA,EAAOG,WAAP,QAAeC,EAAU1D,UAAzB,QACDA,EAAAsC,OACF,IAAAkB,EAAAxD,EAAA6C,MAAA7C,EAAAyC,QAOKa,OAAOG,QAAQE,aAAa3D,EAAO,GAAIwD,QAJvCxD,WAAOA,EAAAkC,GAKR,SAJD0B,KAIOC,GAIV,SAAAC,EAAApB,EAAAqB,GAOGC,EAAMtB,GAAOqB,IALjBE,GACEJ,IACII,EAAM,EACNA,EAAJD,EAAcA,EAAQd,OAAOgB,OAAO,OAPjC,IAAAL,EAAA,MAAAM,MAAA,iEACF,IAAAF,EAAA,EAAAD,EAAAd,OAAAgB,OAAA,MAAAE,EAAAlB,OAAAgB,OAAA,MAQCF,OACAC,IAAAA,SAAAA,GACA,YAAiBI,IAAbJ,EAAJvB,SAAiB2B,IAAAD,EAAA1B,IAEf0B,OAAAA,SAAA1B,QACewB,IAAfF,EAAQd,KACTc,EAAAtB,QAAA2B,QACFA,IAAAD,EAAA1B,KACD0B,EAAO1B,QAAA2B,IAEH3C,IAAA,SAAagB,GAFV,IAAA4B,EAAAN,EAAAtB,GAIL6B,YAAQF,IAARE,EAAuBD,OACHD,KAAfL,EAAAA,EAAAtB,KAEHoB,EAAGM,EAAAE,GAPAA,QAKH,GAOAxC,IAAA,SAASuC,EAAAA,QACM3B,IAAfsB,EAAQI,GAAiBC,EAAzB3B,GAAoCqB,EAClCD,EAAApB,EAAAqB,IAEDS,MAAA,WAhBER,EAAAd,OAAAgB,OAAA,MAkBLpC,EAAKoB,OAAUR,OAAKqB,o4BA/QxBU,gBAAAC,QAAA,oBACAA,QAAQ,wBACR,IAAMC,SAAWC,IAAI,YACjBC,YACAC,cAAgB,EAJpBC,cAMIC,cAAe,EACfC,GADJ1B,MAAIyB,OAAAA,IAAJ,6XAiDoB1E,0BAAlB,SAAAA,EAAYN,GAAMkF,gBAAA7D,KAAAf,GAAA,IAAA6E,EAAAC,2BAAA/D,MAAAf,EAAA+E,WAAAnC,OAAAoC,eAAAhF,IAAAiF,KAAAlE,KAEXV,IAFW,OAGdD,EAAAA,OACA8E,MAAAA,EAFWxF,MAAAU,QAAAA,MAAA,KAGX+E,QAAAA,IACAC,gBAAa1F,EAAM0F,MAJRD,gBAKXpF,OAAQ8E,EAAAnF,MAAA0F,OALVrF,QAAA,GAFgB8E,qBAAA5E,MAAAoF,0DAWhB,OAAItE,KAAKrB,MAAMK,OACNE,MAAAC,cAACT,aAAYK,MAAOiB,KAAKV,QAD9BJ,MAAAC,cAAAT,aAAWM,OAAQqF,OAAA,gBAKxB9D,SAAA2B,MAAAjD,eAIDsF,MAAO,SAASC,EAAQC,GACtB,IAAInF,EAAQU,KAAK0E,SAtBOxF,OAuBxBI,EAAMD,MAAQoF,EAAKpF,MAvBWiF,GAoBlCK,QAAMpE,SAAiBtB,EAAAA,GACrBsF,IAAAA,EAAOvE,KAAA0E,SAELpF,OADAA,EAAIA,QAAQmF,EAAKC,QACXrF,KAWRY,MACEV,GAiCF,WACA,IACAqF,EADAC,GAAA,EAEAjB,GAAAkB,IAAAC,UAAAC,WAEAC,SAAAC,iBAAA,QAAA,SAAAC,GACD,IAAAC,EAAAD,EAAAC,OAS0B,KAAnBA,EAAOC,WAPdR,GAAY,EACPA,EAAaO,EAAjB5D,KACIoD,EAAJQ,EAAA5D,KAAA8D,QAAA,MAAA,KAUG,GAND,IAAAC,EAAA,YAAAN,SAAAO,WACAvD,OAAImD,iBAAA,OAAwB,WAC1BP,WACAD,WACAC,GAAoBrD,GAErB,KASA,GANHS,OAAOiD,iBAAiB,WAAQ,SAAYO,GAC1C/E,GACc,YAAAuE,SAAAO,YACVD,EAAAA,iBAFJE,EAAAC,6BAYMb,GAHJY,SAAIE,KAAAA,YADNf,EAGO,GACLC,GAAIA,KAEH,GAtCL,GA4JG,IAAAe,IAAArD,KAAA,IAzBHsD,YA2BDC,MAMGC,GAAI,0BAHJH,KAAMrD,2BACNsD,IAAAA,wCACFC,KAAM,wCAGJE,MACAC,GAAAA,8BALaC,KAAA,2BAWbF,IAAK,wCAHPG,KAAM,4CAGJH,OACAC,GAAAA,+BAZaC,KAAA,2BAkBbF,IAAK,kDAHPI,KAAO,wDAILH,YAAAA,EAJK/D,MAAAmE,OAAA,SAAA,SAAA5B,EAAA6B,GAfT,IAAAC,GA0BIC,QAASvE,OAAOwE,eAHhBC,UACEL,gBAAiB,UACjBE,QAAM,GAERI,SAAAA,EACEvC,IAAAA,IACApF,OAJMkC,QAAA,EAMR0F,YANQ,cAORC,UAAY,GAEV3F,kBAEA4F,EAAAA,EAAAA,MAAUP,EAAA9B,GAHLiC,OARCjC,EAAVA,EAAAoB,aAeApB,WAAa3F,EAAMyH,MAAK9B,WAAxBA,EAAAoB,mBACSpB,EAAToB,YAGEA,IAAAA,EAAaS,SAAMxH,KAAM+G,MAAAA,KAAYpB,GACrCsC,EA9BK,SAAAC,GA+BN,SAAAD,EAAApI,GAAAkF,gBAAA7D,KAAA+G,GAAA,IAAAE,EAAAlD,2BAAA/D,MAAA+G,EAAA/C,WAAAnC,OAAAoC,eAAA8C,IAAA7C,KAAAlE,KAKSrB,IADW,GAFfyC,EAAAA,MAAUG,EAASC,MAAK0F,EAAM5H,OAK9BwB,KAAMmG,EAAKtI,MAAMmC,MAAQ,IAJzBiG,QAzBsCE,EAAAtI,MAAAyC,SAAAA,EAAA+F,UAAA,OAgCtCC,QAASH,EAAKtI,MAAMyI,SAAW,UANhBH,EAAAI,YAAAJ,EAAA3H,MAAA8H,QAAA,CAWf,IAAME,EAAcL,EAAK3H,MAAM8H,QATjCH,EAAK3H,UAAQgH,WAAYgB,GAAZhB,GACXxF,EAAAA,YAAiBA,WADkBwG,GAClBxG,KACjBM,EAAAA,WAAczC,WAAL2I,GAAK3I,IACdwI,EAAAA,YAHmCtB,WAAAyB,GAAA,KANxC,OAYGL,EAAAM,YAAAN,EAAAM,YAAAC,KAAAP,GAWAA,EAAKQ,eAAiBR,EAAKQ,eAAeD,KAApBP,GATtBA,EAAIS,SAAAT,EAAWG,SAASI,KAApBP,GAdPA,EA/BM,OAAAU,UAAAZ,EAAA3D,gBAAAwE,MAAAC,aAAAd,IAAA1F,IAAA,qBAAAqB,MAAA,WAiDDoF,KAAAf,EAAAgB,UAAA/D,WAAAnC,OAAAoC,eAAA8C,EAAAgB,WAAA,qBAAA/H,MAAAkE,KAAAlE,MACA,IAAAgI,EAAKC,KACNC,EAAAlI,KAAAI,MAAAC,MAAA8H,SAWmBnI,KAAKI,MAAMC,MAAM+H,YATrCF,EAAwBX,KAAAA,MAALc,QAlBFrI,KAAAsI,GAAA,cAAA,SAAA7D,GAqBlB,IAAA8D,EAAA9D,EAAA+D,KAYSC,EAAQhE,EAAK9C,KA3DmB+G,EAAAV,EAAAN,SAAAa,GAAAP,EAAAT,aAkDxCoB,MAAAD,EAAAC,MACAtH,IAAM2G,EAANQ,KACA7G,KAAMuG,MACNnH,KAAM6H,EAAAA,KACNtH,UAAMuH,EAAaX,cAKjBlI,KAAAsI,GAAMG,aAAa9G,SAAnB8C,GACA,OAAMiE,EAAAA,WAAcV,KAKlBrG,IAAAA,EAAM8G,WACN1H,IAAAA,OAAAA,EACAO,EAAAA,OAAgBA,SALDwH,OAAA,GAAjBA,KALFA,EAAAA,EAAAC,UAAA,IAyBehH,SAXfN,KACEqH,EAAOd,MAAKgB,KAAAA,QAAZ,SAAAC,GADF,IAAAC,EAAAD,EAAA/B,MAAA,KAe4B,GAAhBgC,EAAMnH,OAVlBN,EAAAyH,EAAA,KAAA,EAEMzH,EAAAA,EAAJ,IAAAyH,EAAA,MAIEzH,GAAIqH,OAAO/G,EAjBL0G,IAoBFzI,KAAAV,MAAM4J,eACNvF,cACElC,KAAAA,KAAAA,eACD+G,KAAAxI,KAFDV,MAEO+I,OACL5G,KAAAA,EACDV,MAAA,IAGL4C,cAAA,KAtGDtC,IAAA,WAAAqB,MAAA,SAsFgByG,GAoBnB,IAAIC,OAAA,IAAJD,EAAI,YAAAE,QAAJF,GACEG,EAAUtJ,KAAAI,MAAeC,MAAA8H,SACvBK,MAAM,UAANA,EACA7G,EAAM4H,GAFR,UAAyBH,EAK1B9C,EAAAkD,KAAAF,GAAAd,KAAAW,SAL0B,KA3GxB9H,IAAA,cAAAqB,MAAA,SASqC/D,GAAA,IAAA8K,EAAAxH,OAAAV,SA2G1BC,KACd,GAAAxB,KAAMoJ,MAAAA,KAAcD,CACpB,IAAMG,EAAiBlJ,OAALgC,QAAiB+F,MACnC9F,WACEsG,MAAOW,EAAAA,MACRjI,IAAA1C,EAAA0C,IACDmH,KAAIY,EAAQ/H,IACVM,KAAAhD,EAAO2H,KACRlF,QAAApB,KAAAV,MAAA8B,QACFsI,SAAAC,EApHyCC,SAAAnG,cAAA3C,KAAAd,KAAAV,MAAAwB,KAAAG,OAAAjB,KAAAiB,OAuHxCF,KAAM0I,EAAUxH,KAChBX,UAAShC,EAATgC,iBAGIqH,WACAtH,QAAK1C,KAAM0C,MAFHD,QAGRoH,KAAAA,KAAM7J,MAHEmC,KAIRa,OAAMhD,KAAAA,OACNyC,KAAAA,EAASL,OACT2I,GAEA5I,IAAAA,EAAWxB,SAAMwB,SARTiB,OAAA,GASRd,SAAAA,MACAF,MAAAA,EAAMpC,MACN2C,IAAAA,EAAAA,IAXQkH,KAAV7J,EAAA0C,IAaDM,KAfDhD,EAeOgD,KACLU,SAAAA,EACEjB,QAAAA,EACAN,SAAM2C,gBAFEA,mBAjJTpC,IAAA,aAAAqB,MAAA,WA0JDiG,IAAAA,EAAOhK,SAAMgK,MACbtH,IAAAA,EAAK1C,OAFO,EAGZ6J,IAAAA,OAAAA,EACA7G,OAAAA,EA4BIwF,OA3BJuC,KAAAA,MAAUA,MACVG,EAASJ,GANGnK,EAAAoK,SAOZE,EAAUnG,GAAAA,EAAAA,QAeNqG,GAZNrG,WACDkF,MAAAmB,EAAAnB,MA3JyCtH,IAAAyI,EAAAzI,IAAAM,KAAAmI,EAAAnI,KAAAP,QAAApB,KAAAV,MAAA8B,QA8JpC9B,KAAAA,EACAoK,SAAQ,kBACRI,KAAAA,KAAAA,MAAAA,KACAC,OAAAA,KAAAA,OACA5C,UAAWrG,WAIbgJ,EAAIA,SAAYE,MACd3H,WACEsG,QAAAA,KAAOmB,MAAAA,QACPzI,KAAAA,KAAKyI,MAAAA,KACLnI,OAAAA,KAAMmI,OACN1I,UAAAA,SAEAsI,IAGAvC,KAzLH9F,IAAA,iBAAAqB,MAAA,SA4LIuH,EAAAC,GACLJ,IAAAA,EAAAA,MAAatG,IACbnB,IAAAA,EAAUrC,KAAAI,MAAAC,MAAA8J,oBACR/I,EAAAA,KAASsG,SAAAwC,GACTpJ,EAAMsJ,KAAWtJ,WACjBG,GAAAA,EACAkG,OAJFwB,MAAA0B,EAAA1B,MAODH,KAAA6B,EAAA7B,KAcK8B,MAAOD,EAAKC,MAZlBC,IAAOT,EAAAA,IACRU,OAAAH,EAAAG,OA/LyCC,KAAAJ,EAAAI,MAuLnB3J,GAYrB,IAAIqJ,EAAAA,KAAkB7K,MAAKc,WAC3B,GAAgBsH,mBAAZ2C,EAAO,CACXF,IAAAA,EAAAA,EAAgBC,GACd,GAAU,gBAAV,IAAAM,EAAA,YAAArB,QAAAqB,IAAU,CACR,GAAAA,EAAA,SAAO,OAAAA,EAGLJ,GAHK,mBAGED,EAAKC,MAHP,OAAAI,EAAAC,MAAApB,GAILgB,GAJK,mBAIKA,EAJLK,KAKLJ,OAAAA,EAAQH,KAAKG,IAIlB,OAXDP,KA9MG5I,IAAA,UAAAqB,MAAA,SA4NDmI,GAKE,IAAAC,EAAI9K,KAAAV,MAAOoL,OAETR,OAAAA,EAAOQ,OAAAA,EAAOE,OAAAA,EACfG,OAAAA,EAAAC,OAAAA,EAGL,GAFGD,EAAA/K,KAAAiL,WAAAH,GAEH,YAAA9K,KAAOiK,MAAP9C,UAAA,CAMA+C,EAAAxG,WAAA3B,OAAA2B,WAAAA,WAAA3B,OAAA,GAAA,GAeE,IAAImJ,EAAarM,EAAEsM,cAAc3H,SAAU,SAAU4H,GAAK,OAAOA,EAAEzC,OAASmC,IAbxEA,GAAUxL,IAChB4L,GAAA,EAAA1H,SAAS6H,SAATC,MAAA,EAAAJ,GAAAxH,WAAgB6H,WAAhBD,MAAA,EAAAJ,SAqBEhB,EAnBgBe,QAAlBF,KAAAA,MAAa5D,UAmBLzD,WAAWsG,MAhBjBtG,WAAA3B,OAAA2B,WAAAA,WAAA3B,OAAA,GAAA,GAGA/B,KAAAV,MAAA8H,UACA,QAAApH,KAAAV,MAAA8H,SAAA3C,EAAAmC,QAG0DsD,GAASvB,EAAAA,KAATmC,IAA1D9K,KAAAqH,YAAAmE,UAAAC,OAAAzL,KAAAiL,WAAAf,EAAAY,KAAAZ,IACAwB,EAAIR,IAAJ7K,IAAqB6J,EAAAY,OAEnBtH,EAAWA,KAAS8H,eAASJ,KAA7BD,WAAAf,EAAAY,MAEDS,EAAArM,MAAAC,cAAA,OAAAwM,IAAA,UAAAtK,IAAAiF,EAAAsF,SAAA,kBAAAxM,UAAAyL,GAAAa,KAWCH,OAAUvI,EAjBZkH,KAAAA,YAAiBnI,GAAS2B,EAAAA,KAAWA,EAApB3B,UAAoB2B,OAAA1D,KAA/BiL,WAANf,EAAAY,KAAAZ,GAAA,KAaDc,EAAAhL,KAAAyH,eAAAsD,EAAAb,GAED,IAAI2B,EAAA3M,MAAAC,cAAA,OACFwM,IAAA,UACEJ,IAAAA,EAAAA,SAAUvI,kBACV5D,UAAKiI,GACN2D,GAsBH,MAlBuB,QAAjBhL,KAAAV,MAAKoM,WACHA,WAAAA,MACDZ,GAAAA,IACuFY,IAAAA,IAAAA,EAAAA,GAe9FH,GACE7H,EAAgBmI,IAAhBA,MArSCxK,IAAA,eAAAqB,MAAA,WA4SH,GAAA1C,KAAAqH,YAAA,CACA,IAAA8C,EAAAnK,KAAAI,MAAAC,MAAA8J,gBACAE,EAAArK,KAAAqH,YAAAoE,OACA,GAAA,mBAAApB,EAAA,CACA,IAAAK,EAAAL,EAAAF,GACA,GAAA,gBAAA,IAAAO,EAAA,YAAArB,QAAAqB,KACA,mBAAAA,EAAAoB,MAAA,OAAApB,EAAAoB,aAlTGzK,IAAA,oBAAAqB,MAAA,WAyTH,IAAAqJ,EAAA/L,KAAA+L,UACAC,EAAAhM,KAAAgM,WAyB4B,QAAxBhM,KAAKV,MAAM6H,WAA+C,YAAxBnH,KAAKV,MAAM6H,YAvBjD6E,EAAahM,KAAAiI,YACX8D,EAASR,KAAFU,aAEP,IAAAC,EAAOlM,KAAPmM,KAAAN,QACDO,EAAApM,KAAAmM,KAAAZ,QACFW,IAxTyCA,EAAAG,UAAA3J,OAAAqJ,GAAAK,IA2TxCA,EAAS/E,UAAT3E,OAAsBsJ,GAEpBhM,KAAAsM,kBAtUCjL,IAAA,SAAAqB,MAAA,WA0UG,IAAA/D,EAAIqB,KAAO0K,MACZ6B,EAAAvM,KAAArB,MAAA6N,YAAA,eAAAxM,KAAArB,MAAA6N,YAAA,eACFC,EAAAzM,KAAArB,MAAAmI,SAAA,uBAAA,QAAA9G,KAAArB,MAAAyI,QAAA,sBAAA,SAAApH,KAAArB,MAAAyI,QAAA,uBAAA,cACFsF,EAAA1M,KAAA2M,aApUuC3B,EAAAhL,KAAA4M,QAAAH,GAAAI,EAAA3K,MAAA4K,QAAA5N,MAAAC,cAAA,OAAAC,UAAA,eAAAT,EAuUtBoO,WAAAL,EAAA/N,EAAAqO,YAClBvI,EAAIsH,eAGFC,OACAD,MAAAA,cAAAA,OAAAA,UAAYQ,GACbrN,MAAAC,cAAAoB,SAAA0M,EAAAxI,EAAAkC,UACD3G,KAAMkM,MAAAA,SAAkBC,MAAAA,cAALU,EAAKV,MAAxB,GACAnB,OAxVGjE,EAAA,GA8VFmG,GACDC,OAAA,SAAKb,EAAL7H,EAAA2I,GACD,IAAA9N,EAAAU,KAAA0E,SAvVyC,OAAApF,EAAAqC,KAAA8C,EAAA9C,KAAArC,GA2VxC+N,OAAMd,SAAO/H,EAAWgI,EAAAA,GACxB,IAAAlN,EAAMmN,KAAAA,SAqBN,OAlBAnN,EAAM0L,OAAAA,EAAU3C,OAEd5D,EAAK8E,aAAyB5K,EAAAA,WAA9B8F,EAAA8E,YADsB9E,EAEtBA,YAgCAnF,EAAM6H,UAAY1C,EAAK0C,WAAa,QA5BpC,QAAA7H,EAAK6H,WACHiG,EAAAE,KAAA,eACC9E,KAAKlJ,EAAMiO,OACXvC,KAAAA,EAAAA,WAJLjK,KAAA0D,EAAA1D,KAODO,UAAAmD,EAAAnD,YA5WyC,mBAAAmD,EAAA3E,IA+YtCY,WAAW,WAAc+D,EAAK3E,MAAQ,KA9BpCR,IAKN+N,EAAQnL,MAAA6E,EAAUvC,EAAQC,GACxB+I,EAAAC,KAAInO,EAAQsM,SAAKlH,cAkCrB8I,EAAOpN,MAAMK,IAAI,OAAQ+M,EAAOC,MAhC5BD,EAAAE,WACApO,QAAM+I,WAGNmF,EAAAlF,GAAI7D,WAAK8E,SAAYpJ,GAAA,IACnBb,EAAMiK,EAANjK,QAmCEY,EAlCHyN,EAAAvN,MAAAC,IAAA,QAkCsB,WA9BtB,SAFQ8G,EAAW/G,MAAAC,IAAAH,IAoCpBQ,WAAW,WAhCXH,SAAU4G,QAAN9H,MAAmB,SACrB+N,WAAS,WACP5E,SAAMlJ,UADgB6E,QAAA,MAEtBxC,WAAMrC,WACNyB,SAAWA,QAHW1B,MAAA,MAItBiC,WAAWmD,WAJblE,SAAAqN,UAAAzJ,QAAA,MAMDwJ,EAAAvN,MAAAK,IAAAP,EAAA,aAkCQ,MAhCL,MACFQ,MAAyB+D,OAG3B+I,EAAApN,MAAOd,QACR6K,gBAAAqD,IApCYA,EAwCXA,UACJA,MAAOC,SAAS7B,GAChB,gBAAOxL,IAAMK,EAANL,YAAAA,QAAMK,KAAboN,EAAAxO,OACAmO,SAAOE,OAAYG,IAqCjBC,IAAK,WAAuB,IAAdC,EAAcC,UAAAjM,OAAA,QAAAiB,IAAAgL,UAAA,GAAAA,UAAA,GAAN,IAjCxBR,SAAUhN,QAAVnB,MAAsB,SAAiBqB,WAAA,WAoCjCH,SAASqN,UAAUzJ,QAAS,MAlC1B8J,WAAON,WACPzN,SAAAA,QAAmBb,MAAA,OACnBiB,MAoCDyN,KA/BDrN,SAAAA,GAAAA,WAAW,SAAMmN,GACftN,OAAAA,EAAAA,SA6QE,OAvPPiN,EALenH,QAWV9F,aAAAA,SAAiBlB,GAEpB,IAAE0O,EALHvK,SAAAA,SAAAzB,OAAA,GAMDmM,EAAAxE,SAdHwE,EAAAxE,SAAAG,QAAA1H,GAAAF,OAAAV,SAAAC,KAiBA8B,EAAYuG,QAAY1H,GAAAF,OAAAV,SAAiBC,MAGvC2M,aAAA,SAAAhF,GACA,IAAAG,EAAAtJ,KAAAI,MAAAC,MAAA8H,SACA,OAAA7B,EAAAkD,KAAAF,GAAAd,KAAAW,KAEAiF,WAAA,SAAAjO,GACA,OAAAqD,UAEA6K,WAAA,SAAAC,GACAA,IACA9K,SAAA8K,EAAAlM,SAAAoB,SACAE,WAAA4K,EAAAC,OAAA7K,aAbF8K,aAAA,SAAArO,GAsDIqD,YApCAiL,eAEFxI,MAAM,SAAA6E,EAAAnJ,GAFR3B,KAAA0O,aAyCM1O,KAAK2O,KAAK7D,EAAInJ,GAAOZ,MAAM,IAnC/Bf,KAAAiB,QAAAjB,KAAAiB,OAAAtC,QACAqB,KAAAiB,OAAAtC,MAAA0J,OAAAyC,EACA9K,KAAAiB,OAAAtC,MAAA4K,WAAA5H,IAIAiN,OAAA,WACAtM,IAAAA,OAAAA,EAsCE,GAAItC,KAAK6O,cApCTC,EAAIZ,KAAW1K,YACX0K,EAAAA,QAASxE,IAAb,OACEwE,EAAAA,QAASxE,WAAToF,IACK,GAITX,KAAAA,SAAcY,EAAA5O,GACZ,IAAMmJ,OAAAA,EACN,GAAAyF,EAAOzI,CAnBGwI,EAAAC,EAqBAC,KAAAC,UAAAzL,UACVwL,KAAAC,UAAAvL,YADF0K,IArBYc,EAAA1L,SAAAA,SAAAzB,OAAA,GAyBNuM,GACF9K,KAAAA,OAAW8K,SACX5K,QAAAA,SACD6K,MAAA7K,WA5BSyL,QAAAD,GA+BV1L,KAAAA,YAAAsL,EACApL,EAAAA,QAAa0L,QAAbN,EAAAE,KAAAC,UAAAI,MAGAC,QAAI,SAAKZ,EAAcvO,GACrB,IAAA2O,OAAAA,EACD,GAFDC,IAIID,EAAK7N,EACLsF,EAAKtF,QAAOtC,IAAM4K,CACnB5F,cAAA,EACF,IAAA0L,EAAAL,KAAAO,MAAAhJ,EAAAC,QAAAsI,IAGGA,GA7CMvI,EAAAC,QAAAgJ,WAAAV,GA6CNA,EAAAA,QAAJ/M,OAAA,CAMG,IAAAmN,GACFO,KAAAJ,EAAAjN,QAAAiN,EAAAjN,QAAAL,OAAA,GApDSwM,MAAAc,EAAAd,MAAAc,EAAAd,MAAAxM,OAAA,IAkENoN,OAVAJ,SAAMM,EAAAjN,QACR0M,WAAAO,EAAAd,MAyCIvO,KAAK0P,MApCHL,EAAAA,KAAW7G,KACf4B,EAAMnI,KAAOV,OAGJ2N,KAMfI,KAAAA,SAASnG,GAAwB,IAAAwG,EAAA3P,KAAxB2B,EAAwBqM,UAAAjM,OAAA,QAAAiB,IAAAgL,UAAA,GAAAA,UAAA,MAAR7N,EAAQ6N,UAAAjM,OAAA,QAAAiB,IAAAgL,UAAA,GAAAA,UAAA,MAC/BnO,KAAIiP,KAAAA,KAAAA,SAAAA,GACJpO,WAAU,WACRC,KACAmO,OAAAA,KAEEnL,IAAAA,EAAAgM,EAAArC,KAAA,eACAgB,QACA/H,QAAA/C,UAGEqK,OACArF,KAAAW,EACAxH,KAAAA,GAGA0M,WAAUsB,EAAAtB,aAERE,EAAAA,IAAAA,eAuCN,IAAMqB,EAAmBD,EAAKrC,KAAK,cApC/B9J,QACAE,QAAAA,UAIAmK,OAsCArF,KAAMW,EAjCNxH,KAAA,WAAOA,OAAPqB,EAAArB,GAGL0M,WAAAsB,EAAAtB,aAGHM,IAAMkB,IAAmCD,GAAA,iBAAAzG,EAAA,CAAA,IAAA/D,EAAAuK,EAAAxB,aAAAhF,GAuCjC/D,GAtCNvF,EAAAiQ,SACEpP,OAAW0E,EAAAuD,MACThI,WAAAA,EACC+F,UAFH,OA0CI3F,KAAM0D,EAAK1D,KAtCT8O,UAAAA,EAAAA,gBAMFrH,KAAAA,SAAMW,EADDxH,GAAA,IAAAoO,EAAA/P,KAEL2B,KAAAA,KAAAA,KAAMA,SAAAA,GAFDjB,WAL0C,WAgDjDC,KAtCA0N,OAAAA,KAEF,IAAA2B,EAAAD,EAAAzC,KAAA,eAwCEgB,QAtCIsB,QAAAA,UAGF/B,OAH6CrF,KAAAW,EA4C7CxH,KAAMA,GArCN6G,WAAMW,EADDkF,aA2CT0B,EAAKE,IAAI,eAjDwC,IAAjDC,EAAAH,EAAAzC,KAAA,cAoDEgB,QAtCEuB,QAAAA,UAGJhC,OACMzI,KAAAA,EACFA,KAAJzD,GAEI0G,WAAQjD,EAAOuD,aAGf5H,IAAAA,IACAO,EAAAA,CAEH,IAAAoM,KA9CH,GAAAqC,EAAAI,MAAA,WAAA,CA9GU,IAAAC,EAAA5M,SAAAA,SAAAzB,OAAA,GAsMAsO,GAtCN1H,MAAAyH,EAAAzH,MAAuBH,KAAA4H,EAAA5H,KAyCrB7G,KAAMyO,EAAEzO,KAxCTuC,IAAKkM,EAAA1G,SACRhJ,KAAAA,EAAWI,MA4CT,KA5CF4M,EAAAqC,EAAAzC,KAAA,UAAA+C,IA4CkB,OAvChB/B,GAAAA,EAAQ,CACNlM,GAASoB,iBAAAA,EAAAA,OACT,IAAA4B,EAAA2K,EAAA5B,aAAAhF,GAH+C/D,GAKjDyI,EAAOiC,SACLtH,OAAMW,EADDR,MAELhH,WAAMA,EAAAA,SAAAA,EAAAA,GAPyCwF,UAAA,iBAoD5C,CAxCP,IAAK8I,EAAIF,EAATzC,KAAA,cAOS,GALwCgD,EAmB7C3H,OAVF0F,EAAAA,SATFhG,OAAAiI,EAAA3H,MAoDMY,WAAYjD,EAAMxH,SAAUwR,EAAU3O,KAAM+L,GAxC9CsC,UAAAA,SAOOI,EAEPzO,OAAQA,QAHOI,OAIfmI,QAAOR,OAJTrH,WAAAjB,QAAAA,IAAA,UAcEoM","file":"../index.js","sourcesContent":["/**\n * 参考\n * 浏览器“ 后退”、“ 前进” 或可以这么去监听  http://seejs.me/2016/10/19/goback/\n */\n\nimport { Tabs } from 'aotoo-react-tabs'\nrequire('aotoo-mixins-iscroll')\nconst Popstate = SAX('Popstate');\nvar _history = []\nvar _historyCount = 0\nvar _leftStack = []\nvar _restoreStat = false\nvar os\n// var _wr = function(type) {\n//   var orig = window.history[type];\n//   return function() {\n//     var rv = orig.apply(this, arguments);\n//     var e = new Event(type);\n//     e.arguments = arguments;\n//     window.dispatchEvent(e);\n//     return rv;\n//   };\n// };\n// window.history.replaceState = _wr('replaceState');\n// history.replaceState = _wr('pushState');\n\nAotoo.inject.css(`\n  .progress-slot {\n    width: 100%;\n    height: 2px;\n    padding: 0;\n    margin: 0;\n    position: absolute;\n    top: 0;\n    left: 0;\n    z-index: 999;\n  }\n\n  .progress-stat {\n    background-color: #ccc;\n    width: 0;\n    height: 2px;\n    padding: 0;\n    margin: 0;\n    -webkit-transition: all .2s ease-in-out;\n    transition: all .2s ease-in-out;\n  }\n`)\n\nfunction ProgressFun(props) {\n  let _props = _.merge({}, props)\n  if (_props.style && _props.style.enable) delete _props.style.enable\n  return (\n    <div className=\"progress-slot\">\n      <div className=\"progress-stat\" style={_props.style||{width: '0'}}></div>\n    </div>\n  )\n}\n\nclass ProgressClass extends React.Component {\n  constructor(props){\n    super(props)\n    this.state = {\n      width: this.props.width || {width: '0'},\n      opacity: '1',\n      backgroundColor: this.props.backgroundColor,\n      height: this.props.height,\n      enable: true\n    }\n  }\n  render(){\n    if (this.props.enable) {\n      return <ProgressFun style={this.state}/>\n    } else {\n      return <ProgressFun style={{height: '0'}}/>\n    }\n  }\n}\n\nconst Progress = Aotoo(ProgressClass, {\n  WIDTH: function(ostate, opts) {\n    let state = this.curState\n    state.width = opts.width\n    return state\n  },\n  OPACITY: function (ostate, opts) {\n    let state = this.curState\n    state.opacity = opts.opacity\n    return state\n  }\n})\n\nfunction _os(ua) {\n  var ret = {},\n    android = ua.match(/(?:Android);?[\\s\\/]+([\\d.]+)?/),\n    ios = ua.match(/(?:iPad|iPod|iPhone).*OS\\s([\\d_]+)/);\n  ret.mobile = !!(android || ios)\n  return ret;\n}\n\nlet stat = true\nfunction next(params) {\n  stat = true\n}\nfunction once(cb) {\n  if (stat) {\n    stat = false\n    const id = this.saxer.get('__id')\n    const operateId = id + '_OPERATE'\n    const operate = this.saxer.get(operateId)\n    Progress.$width({width: \"70%\"})\n    if (operate) {\n      if (operate == 'break') return   // continue will dealwith flow code\n      else {\n        this.saxer.set(operateId, 'break')\n      }\n    } else {\n      this.saxer.set(operateId, 'break')\n    }\n    setTimeout(() => {\n      this.saxer.set(operateId, 'continue')\n      stat = true\n    }, 1000);\n    cb(next)\n  }\n\n  // clearTimeout(mytimmer)\n  // mytimmer = setTimeout(() => {\n  //   if (stat) {\n  //     stat = false\n  //     cb(next)\n  //   }\n  // }, delay);\n}\n\n(function () {\n  var anchorHash = false\n  var anchorHref\n  os = _os(navigator.userAgent)\n\n  document.addEventListener('click', function (e) {\n    var target = e.target\n    if (target.nodeName == 'A') {\n      anchorHash = false\n      anchorHref = target.href\n      anchorHash = target.href.indexOf('#') > -1 ? true : false\n    }\n  }, false)\n\n  var blockPopstateEvent = document.readyState != \"complete\";\n  window.addEventListener(\"load\", function () {\n    setTimeout(\n      function () {\n        blockPopstateEvent = false;\n      },\n      0)\n  }, false)\n\n  window.addEventListener(\"popstate\", function (evt) {\n    if (blockPopstateEvent && document.readyState == \"complete\") {\n      evt.preventDefault()\n      evt.stopImmediatePropagation()\n    } else {\n      if (anchorHash) {\n        /* do something */\n      } else {\n        Popstate.emit('__goback');\n      }\n      anchorHref = ''\n      anchorHash = false\n    }\n  }, false)\n\n  // window.addEventListener('replaceState', function(e) {\n  //   const argu = e.arguments\n  //   console.log(JSON.stringify(_history))\n  //   if (argu && argu.length) {\n  //     const props = argu[0]\n  //     if (argu[0] == 't') {\n  //       /** do something */\n  //     } else {\n  //       console.log(11111111)\n  //       let lastItem = _history[(_history.length-1)] \n  //       if (lastItem.preState) {\n  //         lastItem.preState.preHref = window.location.href\n  //       } else {\n  //         lastItem.preHref = window.location.href\n  //       }\n  //     }\n  //   }\n  // });\n}())\n\nfunction _pushState(props, nohash) {\n  const flag = props.flag ? (typeof props.flag == 'boolean' ? '#' : props.flag) : ''\n  const init = props.init  // 是否是第一次触发\n  const instProps = props.config.props || {}\n  delete props.config\n\n  const rawurl = props.toggleUrl ? (()=>{\n    return !instProps.rawurl\n  })() : instProps.rawurl\n\n  // const uri = flag ? props.rootUrl + flag + props.key : props.rootUrl\n  const cleanUri = flag ? props.rootUrl + flag + props.key : props.rootUrl\n  const completeUri = init ? window.location.href : (()=>{\n    let query = ''\n    if (props.data && Aotoo.isPlainObject(props.data)) {\n      const datas = Object.keys(props.data)\n      if (datas.length) {\n        query = '?'\n        datas.forEach((key, ii)=>{\n          if (ii<datas.length) {\n            if (ii+1==datas.length) {\n              query += (key+\"=\"+props.data[key])\n            } else {\n              query += (key+\"=\"+props.data[key]+'&')\n            }\n          }\n        })\n      }\n    }\n    return cleanUri + query\n  })()\n  const uri = rawurl ? completeUri : cleanUri\n\n  if (init) {\n    if (!rawurl) window.history.pushState(props, '', uri)\n  } else {\n    window.history.pushState(props, '', uri)\n  }\n}\n\nfunction pushState(props, nohash) {\n  if (props) {\n    if (props.direction && props.direction == 'back') {\n      delete props.config\n      const uri = props.href || props.rootUrl\n      window.history.replaceState(props, '', uri)\n    } else {\n      _pushState(props, nohash)\n    }\n  }\n}\n\nfunction _lru(max) {\n  //https://github.com/dominictarr/hashlru\n  if (!max) throw Error('hashlru must have a max value, of type number, greater than 0')\n  var size = 0, cache = Object.create(null), _cache = Object.create(null)\n  function update(key, value) {\n    cache[key] = value\n    size++\n    if (size >= max) {\n      size = 0\n      _cache = cache\n      cache = Object.create(null)\n    }\n  }\n  return {\n    has: function (key) {\n      return cache[key] !== undefined || _cache[key] !== undefined\n    },\n    remove: function (key) {\n      if(cache[key] !== undefined)\n        cache[key] = undefined\n      if(_cache[key] !== undefined)\n        _cache[key] = undefined\n    },\n    get: function (key) {\n      var v = cache[key]\n      if(v !== undefined) return v\n      if((v = _cache[key]) !== undefined) {\n        update(key, v)\n        return v\n      }\n    },\n    set: function (key, value) {\n      if(cache[key] !== undefined) cache[key] = value\n      else update(key, value)\n    },\n    clear: function () {\n      cache = Object.create(null)\n      _cache = Object.create(null)\n    }\n  }\n}\n\n\nlet lru = _lru(50)\nlet animatecss = {\n  fade: {\n    in: ' fadeIn animated-faster',\n    rein: ' fadeIn animated-fastest',\n    out: ' fadeOut contentHide animated-fastest',\n    back: ' fadeOut contentHide animated-faster'\n  },\n\n  left: {\n    in: ' fadeInLeft animated-faster',\n    rein: ' fadeIn animated-fastest',\n    out: ' fadeOut contentHide animated-fastest',\n    back: ' fadeOutLeft contentHide animated-faster'\n  },\n\n  right: {\n    in: ' fadeInRight animated-faster',\n    rein: ' fadeIn animated-fastest',\n    out: ' outHeight fadeOut contentHide animated-fastest',\n    back: ' outHeight fadeOutRight contentHide animated-faster',\n  }\n}\n\nlet __opts\nAotoo.extend('router', function (opts, utile) {\n  let dft = {\n    storage: window.sessionStorage,\n    progress: {\n      backgroundColor: '#108ee9',\n      enable: true\n    },\n    likeApp: false,   // 模仿app动画切换，保持2个页面, 置为false 可暂时停止prepage页面，提升性能\n    gap: 300,   // 两次点击之间的间隙延时时间，防止click多次响应\n    props: {\n      rawurl: false,  // 影响pushstat操作，true: 保持原始的url地址，false: 切换为精简版url地址。原始地址可以在url上显示query等参数\n      routerClass: 'routerGroup',\n      mulitple: false\n    },\n    iscrollConfig: {}  // 导航栏的iscroll滚动参数设置\n  }\n  opts = utile.merge(dft, opts)\n  __opts = opts\n\n  if (opts.animatecss) {\n    animatecss = utile.merge(animatecss, opts.animatecss)\n    delete opts.animatecss\n  }\n\n  const rootUrl = location.href.split('#')[0]\n  class Router extends Tabs {\n    constructor(props) {\n      super(props)\n      this.state = utile.merge(this.state, {\n        flag: this.props.flag || '#',\n        rootUrl: this.props.rootUrl || rootUrl,\n        direction: 'goto',\n        animate: this.props.animate || 'right'\n      })\n      this.prePageInfo\n\n      if (this.state.animate) {\n        const animateType = this.state.animate  // fade, left, right\n        this.animatein = animatecss[animateType]['in']\n        this.animaterein = animatecss[animateType]['rein']\n        this.animateout = animatecss[animateType]['out']\n        this.animateback = animatecss[animateType]['back']\n      }\n\n      this.historyPush = this.historyPush.bind(this)\n      this.getRealContent = this.getRealContent.bind(this)\n      this.findPath = this.findPath.bind(this)\n    }\n\n    componentWillMount() {\n      super.componentWillMount()\n      const that = this\n      const menuData = this.saxer.get().MenuData\n      const contentData = this.saxer.get().ContentData\n      const selectItem = menuData[this.state.select]\n\n\n      this.on('historypush', function (opts) {\n        const _path = opts.path\n        const _data = opts.data\n        const historyItem = that.findPath(_path)\n\n        that.historyPush({\n          index: historyItem.index,\n          key: historyItem.path,\n          data: _data || {},\n          init: opts.init, // 第一次访问。当直接从url访问时，需不需要对window.history做操作\n          toggleUrl: opts.toggleUrl   // 通过goto, back方法手动控制pushstat地址干净与否\n        })\n      })\n\n      this.on('historypop', function (opts) {\n        return that.historyPop(opts)\n      })\n\n\n      // 第一次访问的数据来自url或者传递过来的selectData\n      const selectData = (()=>{\n        let query\n        let search = window.location.search\n        if (search) {\n          search = search.substring(1)\n          if (search.length) {\n            query = {}\n            search.split('&').forEach(function(item) {\n              const parts = item.split('=')\n              if (parts.length == 1) {\n                query[parts[0]] = true\n              } else {\n                query[parts[0]] = parts[1]\n              }\n            })\n          }\n          if (query) return query\n        }\n        return undefined\n      })() || this.state.selectData || {}\n      if (!_restoreStat) {\n        this.emit('historypush', {\n          path: this.state.select,\n          data: selectData,\n          init: true\n        })\n      }\n      _restoreStat = false\n    }\n\n    findPath(where) {\n      const type = typeof where\n      const menu_data = this.saxer.get().MenuData\n      if (type == 'number') {\n        return menu_data[where]\n      }\n      if (type == 'string') {\n        return utile.find(menu_data, { path: where })\n      }\n    }\n\n    historyPush(props) {\n      const curHref = window.location.href\n      if (this.state.flag) {\n        const curHistoryState = window.history.state\n        pushState({\n          index: props.index,\n          key: props.key,\n          path: props.key,\n          data: props.data,\n          rootUrl: this.state.rootUrl,\n          preState: curHistoryState,\n          timeLine: _historyCount,\n          flag: this.state.flag,\n          config: this.config,\n          init: props.init,\n          toggleUrl: props.toggleUrl\n        })\n      } else {\n        pushState({\n          rootUrl: this.state.rootUrl,\n          flag: this.state.flag,\n          config: this.config,\n          init: props.init\n        }, true)\n      }\n      const preState = _history[_history.length - 1]\n      _history.push({\n        index: props.index,\n        key: props.key,\n        path: props.key,\n        data: props.data,\n        preState: preState,\n        preHref: curHref,\n        timeLine: _historyCount\n      })\n\n      _historyCount++\n    }\n\n    historyPop() {\n      let state = _history.pop()\n      if (!state) return false\n      let rightState;\n      let rightHref\n      if (this.state.flag) {\n        rightState = (state && state.preState)\n        rightHref = (state && state.preHref)\n        // rightHref = (state && state.preState.preHref)\n        if (rightState) {\n          pushState({\n            index: rightState.index,\n            key: rightState.key,\n            data: rightState.data,\n            rootUrl: this.state.rootUrl,\n            href: rightHref,\n            preState: \"curHistoryState\",\n            flag: this.state.flag,\n            config: this.config,\n            direction: 'back'\n          })\n        }\n      } else {\n        rightState = _history.pop()\n        pushState({ \n          rootUrl: this.state.rootUrl, \n          flag: this.state.flag,\n          config: this.config,\n          direction: 'back'\n        }, \n        true)\n      }\n\n      return rightState\n    }\n\n    getRealContent(cnt, pre) {\n      if (!cnt) return ' '\n      let InstanceContext = this.saxer.get().InstanceContext || {}\n      let _pre = this.findPath(pre)\n      InstanceContext.from = (function () {\n        if (_pre) {\n          return {\n            index: _pre.index,\n            path: _pre.path,\n            title: _pre.title,\n            idf: _pre.idf,\n            parent: _pre.parent,\n            attr: _pre.attr\n          }\n        }\n      })()\n      const selectData = this.state.selectData\n      if (typeof cnt == 'function') {\n        let result = cnt(InstanceContext)\n        if (typeof result == 'object') {\n          if (result['$$typeof']) return result\n\n          // enter, leave, main, loaded\n          if (typeof result.enter == 'function') return result.enter(selectData)\n          else if (typeof result.main == 'function') {\n            return result.main(selectData)\n          }\n        }\n      }\n      return cnt\n    }\n\n    getPage(boxCls) {\n      // const xxid = this.saxer.get('__id')\n      // const operateId = xxid + '_OPERATE'\n      // const operate = this.saxer.get(operateId)\n\n      const id = this.state.select;\n      let pre, preId, prePage, preContent;\n      let oriContent, content;\n      oriContent = this.getContent(id);\n\n      if (this.state.direction == 'jumpback') {\n        // content = lru.get(id)\n        // if (!content) {\n        //   oriContent = this.getContent(id)\n        //   content = this.getRealContent(oriContent)\n        // }\n\n        pre = _leftStack.length ? _leftStack[_leftStack.length - 1] : '';\n        let rightIndex = _.findLastIndex(_history, function (o) { return o.index == id })\n        if (rightIndex > -1) {\n          rightIndex += 1\n          _history = _history.slice(0, rightIndex)\n          _leftStack = _leftStack.slice(0, (rightIndex))\n        }\n      }\n      else\n      if (this.state.direction == 'back') {\n        pre = _leftStack.pop()\n      } else {\n        pre = _leftStack.length ? _leftStack[_leftStack.length - 1] : '';\n      }\n\n      if (this.state.animate) {\n        if (this.state.animate == 'fade' || !opts.likeApp) {\n          prePage = undefined\n          this.prePageInfo = (pre && pre.id !== id) ? { origin: this.getContent(pre.id), ...pre} : ''\n        } else {\n          if (pre && pre.id !== id) {\n            this.prePageInfo = { origin: this.getContent(pre.id), ...pre}\n            preContent = lru.get(pre.id)\n            if (!preContent) {\n              preContent = this.getRealContent(this.getContent(pre.id))\n            }\n            prePage = <div ref='prePage' key={utile.uniqueId('Router_Single_')} className={boxCls}>{preContent}</div>\n          }\n        }\n      }\n\n      content = this.getRealContent(oriContent, pre)\n\n      const curPage = <div\n        ref=\"curPage\"\n        key={utile.uniqueId('Router_Single_')}\n        className={boxCls}>\n        {content}\n      </div>\n\n      // 下面的部分有顺序要求，不能随意放置\n      if (this.state.direction == 'goto') {\n        _leftStack.push({\n          id: id,\n        })\n      }\n\n      lru.set(id, content)\n\n      // if (operate == 'break') {\n      //   setTimeout(() => {\n      //     Progress.$width({width: \"100%\"})\n      //     setTimeout(() => {\n      //       Progress.$opacity({opacity: \"0\"})\n      //       setTimeout(() => {\n      //         Progress.$width({width: \"0\"})\n      //         setTimeout(() => {\n      //           Progress.$opacity({opacity: \"1\"})\n      //         }, 200);\n      //       }, 400);\n      //     }, 500);\n      //   }, 1000);\n      //   this.saxer.set(operateId, 'continue')\n      // }\n\n      if (prePage) {\n        return [ prePage, curPage ]\n      } else {\n        return [ curPage ]\n      }\n    }\n\n    leaveContent() {\n      if (this.prePageInfo) {\n        const InstanceContext = this.saxer.get().InstanceContext\n        const _pre = this.prePageInfo.origin\n        if (typeof _pre == 'function') {\n          let result = _pre(InstanceContext)\n          if (typeof result == 'object') {\n            if (typeof result.leave == 'function') return result.leave()\n          }\n        }\n      }\n    }\n\n    componentDidMount() {\n      let animatein = this.animatein\n      let animateout = this.animateout\n      if (this.state.direction == 'back' || this.state.direction == 'jumpback') {\n        animateout = this.animateback\n        animatein = this.animaterein\n      }\n      const curPageDom = this.refs.curPage\n      const prePageDom = this.refs.prePage\n      if (curPageDom) {\n        curPageDom.classList.value += animatein\n      }\n      if (prePageDom) {\n        prePageDom.classList.value += animateout\n      }\n      this.leaveContent()\n    }\n\n    render() {\n      const props = this.props\n      const cls = !this.props.routerClass ? 'routerGroup ' : 'routerGroup ' + this.props.routerClass\n      const boxes_cls = !this.props.mulitple ? (this.props.animate == 'left' ? 'routerBoxes boxLeft' : this.props.animate == 'right' ? 'routerBoxes boxRight' : 'routerBoxes') : 'routerBoxes mulitple'\n      const jsxMenu = this.createMenu()\n      \n      const content = this.getPage(boxes_cls)\n      const IscrollTreeMenu = Aotoo.iscroll(\n        <div className='routerMenus'>{props.treeHeader}{jsxMenu}{props.treeFooter}</div>, \n        opts.iscrollConfig\n      )\n\n      return (\n        <div className={cls}>\n          <Progress.x {...opts.progress}/>\n          {this.state.showMenu ? <IscrollTreeMenu /> : ''}\n          {content}\n        </div>\n      )\n    }\n  }\n\n  const Action = {\n    UPDATE: function (ostate, opts, ctx) {\n      let state = this.curState\n      state.data = opts.data\n      return state\n    },\n\n    SELECT: function (ostate, opts, ctx) {\n      let state = this.curState\n\n      // select\n      state.select = opts.select\n\n      // selectData\n      if (opts.selectData) {\n        state.selectData = opts.selectData\n      }\n\n      if (opts.direction) {\n        state.direction = opts.direction || 'goto'\n      }\n\n      if (state.direction == 'goto') {\n        ctx.emit('historypush', {\n          path: state.select,\n          data: state.selectData,\n          init: opts.init,\n          toggleUrl: opts.toggleUrl\n        })\n      }\n\n      if (typeof opts.cb == 'function') {\n        setTimeout(function () { opts.cb() }, 100);\n      }\n\n      return state\n    },\n  }\n\n  // const router = Aotoo(Tabs, Action, dft)\n  let router = Aotoo(Router, Action, dft)\n  router.__id = _.uniqueId('ROUTER_ID_')\n  router.saxer.set('__id', router.__id)\n  router.condition = {\n    preback: 'preback'\n  }\n  \n  router.on('rendered', function(params) {\n    const {context} = params\n    const xxid = context.saxer.get('__id')\n    const operateId = xxid + '_OPERATE'\n    const operate = context.saxer.get(operateId)\n\n    if (operate == 'break') {\n      setTimeout(() => {\n        Progress.$width({width: \"100%\"})\n        setTimeout(() => {\n          Progress.$opacity({opacity: \"0\"})\n          setTimeout(() => {\n            Progress.$width({width: \"0\"})\n            setTimeout(() => {\n              Progress.$opacity({opacity: \"1\"})\n              context.saxer.set(operateId, 'continue')\n            }, 200);\n          }, 100);\n        }, 100);\n      }, 500);\n    }\n  })\n\n  router.saxer.append({\n    InstanceContext: router\n  })\n\n  router.progress = {\n    start: function(param) {\n      if (typeof param == 'object' && param.width) {\n        Progress.$width(param)\n      }\n    },\n    end: function(timeout=1000) {\n      Progress.$width({width: \"100%\"})\n      setTimeout(() => {\n        Progress.$opacity({opacity: \"0\"})\n        setTimeout(() => {\n          Progress.$width({width: \"0\"})\n        }, 300);\n      }, timeout);\n    }\n  }\n\n  Popstate.on('__goback', function (param) {\n    return router.back()\n\n    // let hash\n    // if (param.href.indexOf('#')>-1) {\n    //   hash = param.href.substr(param.href.indexOf('#')+1)\n    // }\n    // // if (!hash) {\n    // //   return router.back()\n    // // }\n    // if (hash) {\n    //   const lastItem = _history[(_history.length - 1)]\n    //   if (hash !== lastItem.path) {\n    //     return router.back()\n    //   }\n    // }\n  })\n\n  let timmer = {\n    goto: '',\n    back: ''\n  }\n\n  router.extend({\n    // history: function(param){\n    //   if (param) {\n    //     _history = param\n    //   } else {\n    //     return _history\n    //   }\n    // },\n    replaceState: function (uri) {\n      \n      let lastItem = _history[(_history.length-1)] \n      if (lastItem.preState) {\n        lastItem.preState.preHref = uri || window.location.href\n      } else {\n        lastItem.preHref = uri || window.location.href\n      }\n    },\n    getWhereInfo: function (where) {\n      const menu_data = this.saxer.get().MenuData\n      return utile.find(menu_data, { path: where })\n    },\n    getHistory: function (params) {\n      return _history\n    },\n    setHistory: function (record) {\n      if (record) {\n        _history = record.history || _history\n        _leftStack = record.stack || _leftStack\n      }\n    },\n    clearHistory: function (params) {\n      _history = []\n      _leftStack = []\n    },\n    start: function (id, data) {\n      if (this.hasMounted()) {\n        this.goto(id, data, {init: true})\n      } else {\n        if (this.config && this.config.props) {\n          this.config.props.select = id\n          this.config.props.selectData = data\n        }\n      }\n    },\n    delete: function () {\n      let sessName\n      if (this.storageName) {\n        sessName = this.storageName\n        if (dft.storage[sessName]) {\n          dft.storage.removeItem(sessName)\n          return true\n        }\n      }\n    },\n    save: function (name, params) {\n      let sessName\n      if (name) {\n        sessName = name\n        const his = JSON.stringify(_history)\n        const stack = JSON.stringify(_leftStack)\n        const cur = _history[_history.length - 1]\n\n        const sessData = {\n          from: window.location,\n          history: _history,\n          stack: _leftStack,\n          current: cur\n        }\n        this.storageName = sessName\n        dft.storage.setItem(sessName, JSON.stringify(sessData))\n      }\n    },\n    restore: function (name, params) {\n      let sessName\n      if (name) {\n        // sessName = name + '_' + this.globalName\n        sessName = name\n        if (dft.storage[sessName]) {\n          _restoreStat = true\n          const sessData = JSON.parse(dft.storage[sessName])\n          dft.storage.removeItem(sessName)\n\n          if (sessData.history.length) {\n            // var cur = {\n            //   page: sessData.history.pop(),\n            //   stack: sessData.stack.pop()\n            // }\n\n            var cur = {\n              page: sessData.history[sessData.history.length-1],\n              stack: sessData.stack[sessData.stack.length-1]\n            }\n\n            _history = sessData.history\n            _leftStack = sessData.stack\n\n            // _history.pop()\n            // _leftStack.pop()\n            this.start(\n              cur.page.path,\n              cur.page.data\n            )\n  \n            return true\n          }\n        }\n      }\n    },\n\n    goto: function (where, data={}, opts={}) {\n      once.call(this, next => {\n        setTimeout(() => {\n          next()\n        }, __opts.gap);\n\n        const result_beforegoto = this.emit('_beforeGoto', {\n          record: {\n            history: _history,\n            // stack: _leftStack,\n          },\n          param: {\n            path: where,\n            data: data\n          },\n\n          setHistory: this.setHistory\n        })\n        this.off('_beforeGoto')\n\n        const resultBeforegoto = this.emit('beforeGoto', {\n          record: {\n            history: _history,\n            // stack: _leftStack,\n          },\n\n          param: {\n            path: where,\n            data: (data === 'origin' ? undefined : data)\n          },\n\n          setHistory: this.setHistory\n        })\n\n        if (result_beforegoto) return\n        if (resultBeforegoto) return\n\n        if (typeof where != 'string') return\n        const target = this.getWhereInfo(where)\n        if (target) {\n          this.$select({\n            select: target.index,\n            selectData: data,\n            direction: 'goto',\n            init: opts.init,   // 是否是第一次启动，从inst.start进入，第一次进入不会触发pushstat更改window.history状态\n            toggleUrl: opts.toggleUrl\n          })\n        }\n      })\n    },\n\n    back: function (where, data) {\n      once.call(this, next => {\n        setTimeout(() => {\n          next()\n        }, __opts.gap);\n        \n        const result_beforeback = this.emit('_beforeBack', {\n          record: {\n            history: _history,\n            // stack: _leftStack,\n          },\n          param: {\n            path: where,\n            data: data\n          },\n          setHistory: this.setHistory\n        })\n  \n        this.off('_beforeBack')\n  \n        const resultBeforeback = this.emit('beforeBack', {\n          record: {\n            history: _history,\n            // stack: _leftStack,\n          },\n          param: {\n            path: where,\n            data: data\n          },\n          setHistory: this.setHistory\n        })\n  \n        if (result_beforeback) return\n        if (resultBeforeback) return\n  \n        let condition = {}\n        if (this.hasOn('preback')) {\n          const h = _history[_history.length - 1]\n          const whereami = {\n            index: h.index,\n            path: h.path,\n            data: h.data,\n            pre: h.preState,\n            flag: h.flag\n          }\n          condition = this.emit('preback', whereami)\n          if (!condition) return\n        }\n        if (where) {\n          if (typeof where != 'string') return\n          const target = this.getWhereInfo(where)\n          if (target) {\n            this.$select({\n              select: target.index,\n              selectData: utile.merge({}, data, condition),\n              direction: 'jumpback'\n            })\n          }\n        } else {\n          const whereBack = this.emit('historypop')\n          // whereBack: {\n          // index: props.index,\n          // key: props.key,\n          // data: props.data,\n          // rootUrl: this.state.rootUrl,\n          // preState: curHistoryState,\n          // timeLine: _historyCount,\n          // flag: this.state.flag\n          //}\n          if (whereBack) {\n            this.$select({\n              select: whereBack.index,\n              selectData: utile.merge({}, whereBack.data, condition),\n              direction: 'back'\n            })\n            // if (_history.length == 1) {\n            //   _history = []\n            //   _leftStack = []\n            //   history.back()\n            // }\n            return whereBack\n          } else {\n            if (window.history.length) {\n              history.back()\n            } else {\n              pushState({ rootUrl: rootUrl }, true)\n            }\n          }\n        }\n      })\n    }\n  })\n\n  return router\n})"]}