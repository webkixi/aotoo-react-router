{"version":3,"sources":["index.js"],"names":["_os","ua","ret","android","match","ios","mobile","Popstate","stat","cb","params","_historyCount","evt","stopImmediatePropagation","flag","props","uri","anchorHash","rootUrl","key","window","history","pushState","_lru","max","update","value","cache","size","Object","create","_cache","has","undefined","Error","remove","v","set","clear","get","_aotooReactTabs","require","SAX","_history","_leftStack","os","next","navigator","userAgent","document","addEventListener","e","target","nodeName","anchorHref","href","indexOf","blockPopstateEvent","readyState","setTimeout","emit","lru","fade","in","left","animatecss","out","back","rein","Aotoo","extend","opts","utile","dft","right","sessionStorage","mulitple","iscrollConfig","merge","__opts","likeApp","gap","location","split","_Tabs","Router","_classCallCheck","this","_this","_possibleConstructorReturn","__proto__","getPrototypeOf","call","state","animate","prePageInfo","animateType","animatein","animaterein","animateout","animateback","historyPush","bind","getRealContent","_inherits","Tabs","_createClass","_get","prototype","menuData","saxer","MenuData","ContentData","select","on","path","_data","data","historyItem","that","findPath","_path","index","historyPop","contentData","selectItem","where","type","_typeof","find","menu_data","preState","curHistoryState","timeLine","length","push","pop","rightState","cnt","pre","InstanceContext","title","_pre","attr","result","enter","selectData","main","idf","parent","oriContent","getContent","id","direction","rightIndex","slice","preContent","_","findLastIndex","o","prePage","ref","uniqueId","className","boxCls","content","curPage","React","createElement","origin","leave","curPageDom","refs","prePageDom","classList","leaveContent","cls","routerClass","boxes_cls","jsxMenu","getPage","IscrollTreeMenu","iscroll","showMenu","UPDATE","ostate","ctx","curState","SELECT","router","Action","condition","preback","param","getHistory","setHistory","record","stack","clearHistory","start","hasMounted","config","delete","sessName","storageName","storage","removeItem","goto","name","JSON","stringify","sessData","cur","parse","page","_this2","once","from","result_beforegoto","setItem","restore","resultBeforegoto","getWhereInfo","$select","result_beforeback","_this3","hasOn","h","whereami","whereBack"],"mappings":"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","file":"../index.js","sourcesContent":["import { Tabs } from 'aotoo-react-tabs'\nrequire('aotoo-mixins-iscroll')\nconst Popstate = SAX('Popstate');\nvar _history = []\nvar _historyCount = 0\nvar _leftStack = []\nvar os\n\nfunction _os(ua) {\n  var ret = {},\n    android = ua.match(/(?:Android);?[\\s\\/]+([\\d.]+)?/),\n    ios = ua.match(/(?:iPad|iPod|iPhone).*OS\\s([\\d_]+)/);\n  ret.mobile = !!(android || ios)\n  return ret;\n}\n\nlet stat = true\nfunction once(cb) {\n  function next(params) {\n    stat = true\n  }\n  if (stat) {\n    stat = false\n    cb(next)\n  }\n\n  // clearTimeout(mytimmer)\n  // mytimmer = setTimeout(() => {\n  //   if (stat) {\n  //     stat = false\n  //     cb(next)\n  //   }\n  // }, delay);\n}\n\n(function () {\n  var anchorHash = false\n  var anchorHref\n  os = _os(navigator.userAgent)\n\n  document.addEventListener('click', function (e) {\n    var target = e.target\n    if (target.nodeName == 'A') {\n      anchorHash = false\n      anchorHref = target.href\n      anchorHash = target.href.indexOf('#') > -1 ? true : false\n    }\n  }, false)\n\n  var blockPopstateEvent = document.readyState != \"complete\";\n  window.addEventListener(\"load\", function () {\n    setTimeout(\n      function () {\n        blockPopstateEvent = false;\n      },\n      0)\n  }, false)\n\n  window.addEventListener(\"popstate\", function (evt) {\n    if (blockPopstateEvent && document.readyState == \"complete\") {\n      evt.preventDefault()\n      evt.stopImmediatePropagation()\n    } else {\n      if (anchorHash) {\n        /* do something */\n      } else {\n        Popstate.emit('__goback');\n      }\n      anchorHref = ''\n      anchorHash = false\n    }\n  }, false)\n}())\n\nfunction pushState(props, nohash) {\n  const flag = props.flag ? (typeof props.flag == 'boolean' ? '#' : props.flag) : ''\n  const uri = flag ? props.rootUrl + flag + props.key : props.rootUrl\n  window.history.pushState(props, '', uri)\n}\n\nfunction _lru(max) {\n  //https://github.com/dominictarr/hashlru\n  if (!max) throw Error('hashlru must have a max value, of type number, greater than 0')\n  var size = 0, cache = Object.create(null), _cache = Object.create(null)\n  function update(key, value) {\n    cache[key] = value\n    size++\n    if (size >= max) {\n      size = 0\n      _cache = cache\n      cache = Object.create(null)\n    }\n  }\n  return {\n    has: function (key) {\n      return cache[key] !== undefined || _cache[key] !== undefined\n    },\n    remove: function (key) {\n      if (cache[key] !== undefined)\n        cache[key] = undefined\n      if (_cache[key] !== undefined)\n        _cache[key] = undefined\n    },\n    get: function (key) {\n      var v = cache[key]\n      if (v !== undefined) return v\n      if (v = _cache[key]) {\n        update(key, v)\n        return v\n      }\n    },\n    set: function (key, value) {\n      if (cache[key] !== undefined) cache[key] = value\n      else update(key, value)\n    },\n    clear: function () {\n      cache = Object.create(null)\n      _cache = Object.create(null)\n    }\n  }\n}\n\n\nlet lru = _lru(50)\nlet animatecss = {\n  fade: {\n    in: ' fadeIn animated-faster',\n    rein: ' fadeIn animated-fastest',\n    out: ' fadeOut contentHide animated-fastest',\n    back: ' fadeOut contentHide animated-faster'\n  },\n\n  left: {\n    in: ' fadeInLeft animated-faster',\n    rein: ' fadeIn animated-fastest',\n    out: ' fadeOut contentHide animated-fastest',\n    back: ' fadeOutLeft contentHide animated-faster'\n  },\n\n  right: {\n    in: ' fadeInRight animated-faster',\n    rein: ' fadeIn animated-fastest',\n    out: ' outHeight fadeOut contentHide animated-fastest',\n    back: ' outHeight fadeOutRight contentHide animated-faster',\n  }\n}\n\nlet __opts\nAotoo.extend('router', function (opts, utile) {\n  let dft = {\n    storage: window.sessionStorage,\n    likeApp: false,   // 模仿app的效果，比如动画切换，保持2个页面\n    gap: 100,   // 两次点击之间的间隙延时时间，防止click多次响应\n    props: {\n      routerClass: 'routerGroup',\n      mulitple: false\n    },\n    iscrollConfig: {}  // 导航栏的iscroll滚动参数设置\n  }\n  opts = utile.merge(dft, opts)\n  __opts = opts\n\n  if (opts.animatecss) {\n    animatecss = utile.merge(animatecss, opts.animatecss)\n    delete opts.animatecss\n  }\n\n  const rootUrl = location.href.split('#')[0]\n  class Router extends Tabs {\n    constructor(props) {\n      super(props)\n      this.state = utile.merge(this.state, {\n        flag: this.props.flag || '#',\n        rootUrl: this.props.rootUrl || rootUrl,\n        direction: 'goto',\n        animate: this.props.animate || 'right'\n      })\n      this.prePageInfo\n\n      if (this.state.animate) {\n        const animateType = this.state.animate  // fade, left, right\n        this.animatein = animatecss[animateType]['in']\n        this.animaterein = animatecss[animateType]['rein']\n        this.animateout = animatecss[animateType]['out']\n        this.animateback = animatecss[animateType]['back']\n      }\n\n      this.historyPush = this.historyPush.bind(this)\n      this.getRealContent = this.getRealContent.bind(this)\n      this.findPath = this.findPath.bind(this)\n    }\n\n    componentWillMount() {\n      super.componentWillMount()\n      const that = this\n      const menuData = this.saxer.get().MenuData\n      const contentData = this.saxer.get().ContentData\n      const selectItem = menuData[this.state.select]\n\n\n      this.on('historypush', function (opts) {\n        const _path = opts.path\n        const _data = opts.data\n        const historyItem = that.findPath(_path)\n\n        that.historyPush({\n          index: historyItem.index,\n          key: historyItem.path,\n          data: _data || {}\n        })\n      })\n\n      this.on('historypop', function (opts) {\n        return that.historyPop(opts)\n      })\n\n      this.emit('historypush', {\n        path: this.state.select,\n        data: {}\n      })\n    }\n\n    findPath(where) {\n      const type = typeof where\n      const menu_data = this.saxer.get().MenuData\n      if (type == 'number') {\n        return menu_data[where]\n      }\n      if (type == 'string') {\n        return utile.find(menu_data, { path: where })\n      }\n    }\n\n    historyPush(props) {\n      if (this.state.flag) {\n        const curHistoryState = window.history.state\n        pushState({\n          index: props.index,\n          key: props.key,\n          path: props.key,\n          data: props.data,\n          rootUrl: this.state.rootUrl,\n          preState: curHistoryState,\n          timeLine: _historyCount,\n          flag: this.state.flag\n        })\n      } else {\n        pushState({\n          rootUrl: this.state.rootUrl,\n          flag: this.state.flag\n        }, true)\n      }\n      const preState = _history[_history.length - 1]\n      _history.push({\n        index: props.index,\n        key: props.key,\n        path: props.key,\n        data: props.data,\n        preState: preState,\n        timeLine: _historyCount\n      })\n\n      _historyCount++\n    }\n\n    historyPop() {\n      let state = _history.pop()\n      if (!state) return false\n      let rightState;\n      if (this.state.flag) {\n        rightState = (state && state.preState)\n        if (rightState) {\n          pushState({\n            index: rightState.index,\n            key: rightState.key,\n            data: rightState.data,\n            rootUrl: this.state.rootUrl,\n            preState: \"curHistoryState\",\n            flag: this.state.flag\n          })\n        }\n      } else {\n        rightState = _history.pop()\n        pushState({ rootUrl: this.state.rootUrl, flag: this.state.flag }, true)\n      }\n\n      return rightState\n    }\n\n    getRealContent(cnt, pre) {\n      if (!cnt) return ' '\n      let InstanceContext = this.saxer.get().InstanceContext || {}\n      let _pre = this.findPath(pre)\n      InstanceContext.from = (function () {\n        if (_pre) {\n          return {\n            index: _pre.index,\n            path: _pre.path,\n            title: _pre.title,\n            idf: _pre.idf,\n            parent: _pre.parent,\n            attr: _pre.attr\n          }\n        }\n      })()\n      const selectData = this.state.selectData\n      if (typeof cnt == 'function') {\n        let result = cnt(InstanceContext)\n        if (typeof result == 'object') {\n          if (result['$$typeof']) return result\n\n          // enter, leave, main, loaded\n          if (typeof result.enter == 'function') return result.enter(selectData)\n          else if (typeof result.main == 'function') {\n            return result.main(selectData)\n          }\n        }\n      }\n      return cnt\n    }\n\n    getPage(boxCls) {\n      const id = this.state.select\n      let pre, preId, prePage, preContent\n      let oriContent, content\n      oriContent = this.getContent(id)\n\n      if (this.state.direction == 'jumpback') {\n        // content = lru.get(id)\n        // if (!content) {\n        //   oriContent = this.getContent(id)\n        //   content = this.getRealContent(oriContent)\n        // }\n\n        pre = _leftStack.length ? _leftStack[_leftStack.length - 1] : '';\n        let rightIndex = _.findLastIndex(_history, function (o) { return o.index == id })\n        if (rightIndex > -1) {\n          rightIndex += 1\n          _history = _history.slice(0, rightIndex)\n          _leftStack = _leftStack.slice(0, (rightIndex))\n        }\n      }\n      else\n        if (this.state.direction == 'back') {\n          pre = _leftStack.pop()\n        } else {\n          pre = _leftStack.length ? _leftStack[_leftStack.length - 1] : '';\n        }\n\n      if (this.state.animate) {\n        if (this.state.animate == 'fade' || !dft.likeApp) {\n          // prePage = <div ref='prePage' key={utile.uniqueId('Router_Single_')} className={boxCls} />\n          prePage = undefined\n        } else {\n          pre = undefined  //暂时封住前一页的逻辑\n          if (pre && pre.id !== id) {\n            // this.prePageInfo = pre\n            // preContent = this.getRealContent(this.getContent(pre.id))\n\n            this.prePageInfo = pre\n            preContent = lru.get(pre.id)\n            if (!preContent) {\n              preContent = this.getRealContent(this.getContent(pre.id))\n            }\n\n            prePage = <div ref='prePage' key={utile.uniqueId('Router_Single_')} className={boxCls}>{preContent}</div>\n          }\n        }\n      }\n\n      content = this.getRealContent(oriContent, pre)\n\n      const curPage = <div\n        ref=\"curPage\"\n        key={utile.uniqueId('Router_Single_')}\n        className={boxCls}>\n        {content}\n      </div>\n\n      // 下面的部分有顺序要求，不能随意放置\n      if (this.state.direction == 'goto') {\n        _leftStack.push({\n          id: id,\n          // origin: oriContent\n          // content: content,\n        })\n      }\n\n      lru.set(id, content)\n\n      if (prePage) {\n        return [ prePage, curPage ]  //暂时屏蔽前一页\n      } else {\n        return [ curPage ]\n      }\n    }\n\n    leaveContent() {\n      if (this.prePageInfo) {\n        const InstanceContext = this.saxer.get().InstanceContext\n        const _pre = this.prePageInfo.origin\n        if (typeof _pre == 'function') {\n          let result = _pre(InstanceContext)\n          if (typeof result == 'object') {\n            if (typeof result.leave == 'function') return result.leave()\n          }\n        }\n      }\n    }\n\n    componentDidMount() {\n      let animatein = this.animatein\n      let animateout = this.animateout\n      if (this.state.direction == 'back' || this.state.direction == 'jumpback') {\n        animateout = this.animateback\n        animatein = this.animaterein\n      }\n      const curPageDom = this.refs.curPage\n      const prePageDom = this.refs.prePage\n      if (curPageDom) {\n        curPageDom.classList.value += animatein\n      }\n      if (prePageDom) {\n        prePageDom.classList.value += animateout\n      }\n      this.leaveContent()\n    }\n\n    // componentDidUpdate(prevProps, prevState) {\n    //   // this.leaveContent()\n    // }\n\n    render() {\n      const cls = !this.props.routerClass ? 'routerGroup ' : 'routerGroup ' + this.props.routerClass\n      // const boxes_cls = !this.props.mulitple ? 'routerBoxes' : 'routerBoxes mulitple'\n      const boxes_cls = !this.props.mulitple ? (this.props.animate == 'left' ? 'routerBoxes boxLeft' : this.props.animate == 'right' ? 'routerBoxes boxRight' : 'routerBoxes') : 'routerBoxes mulitple'\n\n      // const jsxMenu = this.saxer.get().MenuJsx\n      const jsxMenu = this.createMenu()\n\n      const content = this.getPage(boxes_cls)\n      const IscrollTreeMenu = Aotoo.iscroll(\n        <div className='routerMenus'>{jsxMenu}</div>, \n        opts.iscrollConfig\n      )\n\n      return (\n        <div className={cls}>\n          {this.state.showMenu ? <IscrollTreeMenu /> : ''}\n          {content}\n        </div>\n      )\n    }\n  }\n\n  const Action = {\n    UPDATE: function (ostate, opts, ctx) {\n      let state = this.curState\n      state.data = opts.data\n      return state\n    },\n\n    SELECT: function (ostate, opts, ctx) {\n      let state = this.curState\n\n      // select\n      state.select = opts.select\n\n      // selectData\n      if (opts.selectData) {\n        state.selectData = opts.selectData\n      }\n\n      if (opts.direction) {\n        state.direction = opts.direction || 'goto'\n      }\n\n      if (state.direction == 'goto') {\n        ctx.emit('historypush', {\n          path: state.select,\n          data: state.selectData\n        })\n      }\n\n      if (typeof opts.cb == 'function') {\n        setTimeout(function () { opts.cb() }, 100);\n      }\n\n      return state\n    },\n  }\n\n  // const router = Aotoo(Tabs, Action, dft)\n  const router = Aotoo(Router, Action, dft)\n  router.condition = {\n    preback: 'preback'\n  }\n\n  router.saxer.append({\n    InstanceContext: router\n  })\n\n  Popstate.on('__goback', function (param) {\n    return router.back()\n\n    // let hash\n    // if (param.href.indexOf('#')>-1) {\n    //   hash = param.href.substr(param.href.indexOf('#')+1)\n    // }\n    // // if (!hash) {\n    // //   return router.back()\n    // // }\n    // if (hash) {\n    //   const lastItem = _history[(_history.length - 1)]\n    //   if (hash !== lastItem.path) {\n    //     return router.back()\n    //   }\n    // }\n  })\n\n  let timmer = {\n    goto: '',\n    back: ''\n  }\n\n  router.extend({\n    getWhereInfo: function (where) {\n      const menu_data = this.saxer.get().MenuData\n      return utile.find(menu_data, { path: where })\n    },\n    getHistory: function (params) {\n      return _history\n    },\n    setHistory: function (record) {\n      if (record) {\n        _history = record.history || _history\n        _leftStack = record.stack || _leftStack\n      }\n    },\n    clearHistory: function (params) {\n      _history = []\n      _leftStack = []\n    },\n    start: function (id, data) {\n      if (this.hasMounted()) {\n        this.goto(id, data)\n      } else {\n        if (this.config && this.config.props) {\n          this.config.props.select = id\n          this.config.props.selectData = data\n        }\n      }\n    },\n    delete: function () {\n      let sessName\n      if (this.storageName) {\n        sessName = this.storageName\n        if (dft.storage[sessName]) {\n          dft.storage.removeItem(sessName)\n          return true\n        }\n      }\n    },\n    save: function (name, params) {\n      let sessName\n      if (name) {\n        sessName = name\n        const his = JSON.stringify(_history)\n        const stack = JSON.stringify(_leftStack)\n        const cur = _history[_history.length - 1]\n\n        const sessData = {\n          from: window.location,\n          history: _history,\n          stack: _leftStack,\n          current: cur\n        }\n        this.storageName = sessName\n        dft.storage.setItem(sessName, JSON.stringify(sessData))\n      }\n    },\n    restore: function (name, params) {\n      let sessName\n      if (name) {\n        // sessName = name + '_' + this.globalName\n        sessName = name\n        if (dft.storage[sessName]) {\n          const sessData = JSON.parse(dft.storage[sessName])\n          dft.storage.removeItem(sessName)\n\n          if (sessData.history.length) {\n            var cur = {\n              page: sessData.history.pop(),\n              stack: sessData.stack.pop()\n            }\n\n            _history = sessData.history\n            _leftStack = sessData.stack\n\n            // _history.pop()\n            // _leftStack.pop()\n            this.start(\n              cur.page.path,\n              cur.page.data\n            )\n  \n            return true\n          }\n        }\n      }\n    },\n\n    goto: function (where, data) {\n      once( next => {\n        setTimeout(() => {\n          next()\n        }, __opts.gap);\n\n        const result_beforegoto = this.emit('_beforeGoto', {\n          record: {\n            history: _history,\n            // stack: _leftStack,\n          },\n          param: {\n            path: where,\n            data: data\n          },\n\n          setHistory: this.setHistory\n        })\n        this.off('_beforeGoto')\n\n        const resultBeforegoto = this.emit('beforeGoto', {\n          record: {\n            history: _history,\n            // stack: _leftStack,\n          },\n\n          param: {\n            path: where,\n            data: data\n          },\n\n          setHistory: this.setHistory\n        })\n\n        if (result_beforegoto) return\n        if (resultBeforegoto) return\n\n        if (typeof where != 'string') return\n        const target = this.getWhereInfo(where)\n        if (target) {\n          this.$select({\n            select: target.index,\n            selectData: data,\n            direction: 'goto'\n          })\n        }\n      })\n    },\n\n    back: function (where, data) {\n      once( next => {\n        setTimeout(() => {\n          next()\n        }, __opts.gap);\n        \n        const result_beforeback = this.emit('_beforeBack', {\n          record: {\n            history: _history,\n            // stack: _leftStack,\n          },\n          param: {\n            path: where,\n            data: data\n          },\n          setHistory: this.setHistory\n        })\n  \n        this.off('_beforeBack')\n  \n        const resultBeforeback = this.emit('beforeBack', {\n          record: {\n            history: _history,\n            // stack: _leftStack,\n          },\n          param: {\n            path: where,\n            data: data\n          },\n          setHistory: this.setHistory\n        })\n  \n        if (result_beforeback) return\n        if (resultBeforeback) return\n  \n        let condition = {}\n        if (this.hasOn('preback')) {\n          const h = _history[_history.length - 1]\n          const whereami = {\n            index: h.index,\n            path: h.path,\n            data: h.data,\n            pre: h.preState,\n            flag: h.flag\n          }\n          condition = this.emit('preback', whereami)\n          if (!condition) return\n        }\n        if (where) {\n          if (typeof where != 'string') return\n          const target = this.getWhereInfo(where)\n          if (target) {\n            this.$select({\n              select: target.index,\n              selectData: utile.merge({}, data, condition),\n              direction: 'jumpback'\n            })\n          }\n        } else {\n          const whereBack = this.emit('historypop')\n          // whereBack: {\n          // index: props.index,\n          // key: props.key,\n          // data: props.data,\n          // rootUrl: this.state.rootUrl,\n          // preState: curHistoryState,\n          // timeLine: _historyCount,\n          // flag: this.state.flag\n          //}\n          if (whereBack) {\n            this.$select({\n              select: whereBack.index,\n              selectData: utile.merge({}, whereBack.data, condition),\n              direction: 'back'\n            })\n            return whereBack\n          } else {\n            if (window.history.length) {\n              history.back()\n            } else {\n              pushState({ rootUrl: rootUrl }, true)\n            }\n          }\n        }\n      })\n    }\n  })\n\n  return router\n})"]}