{"version":3,"sources":["index.js"],"names":["ProgressFun","props","_props","_","merge","style","enable","React","createElement","className","width","_os","ua","OPACITY","android","state","match","curState","opacity","ret","mobile","ios","params","stat","cb","this","saxer","get","next","operateId","$width","operate","once","set","id","Progress","Popstate","emit","nohash","flag","anchorHref","rootUrl","key","anchorHash","uri","_lru","max","window","history","pushState","size","_cache","cache","Object","Error","create","has","undefined","value","remove","v","update","_aotooReactTabs","require","SAX","_history","_historyCount","_leftStack","os","Aotoo","inject","css","ProgressClass","_classCallCheck","_this","_possibleConstructorReturn","__proto__","getPrototypeOf","call","backgroundColor","height","Component","WIDTH","ostate","opts","navigator","userAgent","document","addEventListener","e","target","nodeName","href","indexOf","blockPopstateEvent","readyState","setTimeout","evt","preventDefault","stopImmediatePropagation","fade","in","rein","out","lru","back","utile","storage","sessionStorage","progress","__opts","likeApp","dft","routerClass","animatecss","iscrollConfig","location","split","_Tabs","_this3","direction","Router","animate","prePageInfo","animateType","animatein","animaterein","bind","getRealContent","findPath","_inherits","Tabs","_createClass","_get","prototype","that","menuData","animateout","select","on","path","_data","data","historyItem","_path","historyPush","index","selectItem","historyPop","type","where","_typeof","menu_data","MenuData","find","curHistoryState","preState","timeLine","length","pop","rightState","pre","InstanceContext","_pre","title","attr","selectData","cnt","result","enter","main","parent","boxCls","preContent","oriContent","content","getContent","rightIndex","findLastIndex","o","slice","prePage","_extends","origin","ref","uniqueId","curPage","leave","animateback","curPageDom","refs","classList","prePageDom","leaveContent","cls","boxes_cls","mulitple","jsxMenu","IscrollTreeMenu","iscroll","Action","ctx","SELECT","getPage","router","__id","condition","context","$opacity","append","start","param","preback","timeout","arguments","xxid","getWhereInfo","end","getHistory","record","stack","clearHistory","hasMounted","goto","config","delete","sessName","storageName","timmer","removeItem","save","name","extend","JSON","stringify","sessData","setHistory","setItem","restore","cur","page","his","_this4","current","result_beforegoto","off","resultBeforegoto","_this5","gap","result_beforeback","$select","resultBeforeback","hasOn","h","whereami","whereBack"],"mappings":"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","file":"../index.js","sourcesContent":["import { Tabs } from 'aotoo-react-tabs'\nrequire('aotoo-mixins-iscroll')\nconst Popstate = SAX('Popstate');\nvar _history = []\nvar _historyCount = 0\nvar _leftStack = []\nvar os\n\nAotoo.inject.css(`\n  .progress-slot {\n    width: 100%;\n    height: 2px;\n    padding: 0;\n    margin: 0;\n    position: absolute;\n    top: 0;\n    left: 0;\n    z-index: 999;\n  }\n\n  .progress-stat {\n    background-color: #ccc;\n    width: 0;\n    height: 2px;\n    padding: 0;\n    margin: 0;\n    -webkit-transition: all .2s ease-in-out;\n    transition: all .2s ease-in-out;\n  }\n`)\n\nfunction ProgressFun(props) {\n  let _props = _.merge({}, props)\n  if (_props.style && _props.style.enable) delete _props.style.enable\n  return (\n    <div className=\"progress-slot\">\n      <div className=\"progress-stat\" style={_props.style||{width: '0'}}></div>\n    </div>\n  )\n}\n\nclass ProgressClass extends React.Component {\n  constructor(props){\n    super(props)\n    this.state = {\n      width: this.props.width || {width: '0'},\n      opacity: '1',\n      backgroundColor: this.props.backgroundColor,\n      height: this.props.height,\n      enable: true\n    }\n  }\n  render(){\n    if (this.props.enable) {\n      return <ProgressFun style={this.state}/>\n    } else {\n      return <ProgressFun style={{height: '0'}}/>\n    }\n  }\n}\n\nconst Progress = Aotoo(ProgressClass, {\n  WIDTH: function(ostate, opts) {\n    let state = this.curState\n    state.width = opts.width\n    return state\n  },\n  OPACITY: function (ostate, opts) {\n    let state = this.curState\n    state.opacity = opts.opacity\n    return state\n  }\n})\n\nfunction _os(ua) {\n  var ret = {},\n    android = ua.match(/(?:Android);?[\\s\\/]+([\\d.]+)?/),\n    ios = ua.match(/(?:iPad|iPod|iPhone).*OS\\s([\\d_]+)/);\n  ret.mobile = !!(android || ios)\n  return ret;\n}\n\nlet stat = true\nfunction next(params) {\n  stat = true\n}\nfunction once(cb) {\n  if (stat) {\n    stat = false\n    const id = this.saxer.get('__id')\n    const operateId = id + '_OPERATE'\n    const operate = this.saxer.get(operateId)\n    Progress.$width({width: \"70%\"})\n    if (operate) {\n      if (operate == 'break') return   // continue will dealwith flow code\n      else {\n        this.saxer.set(operateId, 'break')\n        setTimeout(() => {\n          this.saxer.set(operateId, 'continue')\n        }, 1000);\n      }\n    } else {\n      this.saxer.set(operateId, 'break')\n    }\n    cb(next)\n  }\n\n  // clearTimeout(mytimmer)\n  // mytimmer = setTimeout(() => {\n  //   if (stat) {\n  //     stat = false\n  //     cb(next)\n  //   }\n  // }, delay);\n}\n\n(function () {\n  var anchorHash = false\n  var anchorHref\n  os = _os(navigator.userAgent)\n\n  document.addEventListener('click', function (e) {\n    var target = e.target\n    if (target.nodeName == 'A') {\n      anchorHash = false\n      anchorHref = target.href\n      anchorHash = target.href.indexOf('#') > -1 ? true : false\n    }\n  }, false)\n\n  var blockPopstateEvent = document.readyState != \"complete\";\n  window.addEventListener(\"load\", function () {\n    setTimeout(\n      function () {\n        blockPopstateEvent = false;\n      },\n      0)\n  }, false)\n\n  window.addEventListener(\"popstate\", function (evt) {\n    if (blockPopstateEvent && document.readyState == \"complete\") {\n      evt.preventDefault()\n      evt.stopImmediatePropagation()\n    } else {\n      if (anchorHash) {\n        /* do something */\n      } else {\n        Popstate.emit('__goback');\n      }\n      anchorHref = ''\n      anchorHash = false\n    }\n  }, false)\n}())\n\nfunction pushState(props, nohash) {\n  const flag = props.flag ? (typeof props.flag == 'boolean' ? '#' : props.flag) : ''\n  const uri = flag ? props.rootUrl + flag + props.key : props.rootUrl\n  window.history.pushState(props, '', uri)\n}\n\nfunction _lru(max) {\n  //https://github.com/dominictarr/hashlru\n  if (!max) throw Error('hashlru must have a max value, of type number, greater than 0')\n  var size = 0, cache = Object.create(null), _cache = Object.create(null)\n  function update(key, value) {\n    cache[key] = value\n    size++\n    if (size >= max) {\n      size = 0\n      _cache = cache\n      cache = Object.create(null)\n    }\n  }\n  return {\n    has: function (key) {\n      return cache[key] !== undefined || _cache[key] !== undefined\n    },\n    remove: function (key) {\n      if(cache[key] !== undefined)\n        cache[key] = undefined\n      if(_cache[key] !== undefined)\n        _cache[key] = undefined\n    },\n    get: function (key) {\n      var v = cache[key]\n      if(v !== undefined) return v\n      if((v = _cache[key]) !== undefined) {\n        update(key, v)\n        return v\n      }\n    },\n    set: function (key, value) {\n      if(cache[key] !== undefined) cache[key] = value\n      else update(key, value)\n    },\n    clear: function () {\n      cache = Object.create(null)\n      _cache = Object.create(null)\n    }\n  }\n}\n\n\nlet lru = _lru(50)\nlet animatecss = {\n  fade: {\n    in: ' fadeIn animated-faster',\n    rein: ' fadeIn animated-fastest',\n    out: ' fadeOut contentHide animated-fastest',\n    back: ' fadeOut contentHide animated-faster'\n  },\n\n  left: {\n    in: ' fadeInLeft animated-faster',\n    rein: ' fadeIn animated-fastest',\n    out: ' fadeOut contentHide animated-fastest',\n    back: ' fadeOutLeft contentHide animated-faster'\n  },\n\n  right: {\n    in: ' fadeInRight animated-faster',\n    rein: ' fadeIn animated-fastest',\n    out: ' outHeight fadeOut contentHide animated-fastest',\n    back: ' outHeight fadeOutRight contentHide animated-faster',\n  }\n}\n\nlet __opts\nAotoo.extend('router', function (opts, utile) {\n  let dft = {\n    storage: window.sessionStorage,\n    progress: {\n      backgroundColor: '#108ee9',\n      enable: true\n    },\n    likeApp: false,   // 模仿app动画切换，保持2个页面, 置为false 可暂时停止prepage页面，提升性能\n    gap: 300,   // 两次点击之间的间隙延时时间，防止click多次响应\n    props: {\n      routerClass: 'routerGroup',\n      mulitple: false\n    },\n    iscrollConfig: {}  // 导航栏的iscroll滚动参数设置\n  }\n  opts = utile.merge(dft, opts)\n  __opts = opts\n\n  if (opts.animatecss) {\n    animatecss = utile.merge(animatecss, opts.animatecss)\n    delete opts.animatecss\n  }\n\n  const rootUrl = location.href.split('#')[0]\n  class Router extends Tabs {\n    constructor(props) {\n      super(props)\n      this.state = utile.merge(this.state, {\n        flag: this.props.flag || '#',\n        rootUrl: this.props.rootUrl || rootUrl,\n        direction: 'goto',\n        animate: this.props.animate || 'right'\n      })\n      this.prePageInfo\n\n      if (this.state.animate) {\n        const animateType = this.state.animate  // fade, left, right\n        this.animatein = animatecss[animateType]['in']\n        this.animaterein = animatecss[animateType]['rein']\n        this.animateout = animatecss[animateType]['out']\n        this.animateback = animatecss[animateType]['back']\n      }\n\n      this.historyPush = this.historyPush.bind(this)\n      this.getRealContent = this.getRealContent.bind(this)\n      this.findPath = this.findPath.bind(this)\n    }\n\n    componentWillMount() {\n      super.componentWillMount()\n      const that = this\n      const menuData = this.saxer.get().MenuData\n      const contentData = this.saxer.get().ContentData\n      const selectItem = menuData[this.state.select]\n\n\n      this.on('historypush', function (opts) {\n        const _path = opts.path\n        const _data = opts.data\n        const historyItem = that.findPath(_path)\n\n        that.historyPush({\n          index: historyItem.index,\n          key: historyItem.path,\n          data: _data || {}\n        })\n      })\n\n      this.on('historypop', function (opts) {\n        return that.historyPop(opts)\n      })\n\n      this.emit('historypush', {\n        path: this.state.select,\n        data: {}\n      })\n    }\n\n    findPath(where) {\n      const type = typeof where\n      const menu_data = this.saxer.get().MenuData\n      if (type == 'number') {\n        return menu_data[where]\n      }\n      if (type == 'string') {\n        return utile.find(menu_data, { path: where })\n      }\n    }\n\n    historyPush(props) {\n      if (this.state.flag) {\n        const curHistoryState = window.history.state\n        pushState({\n          index: props.index,\n          key: props.key,\n          path: props.key,\n          data: props.data,\n          rootUrl: this.state.rootUrl,\n          preState: curHistoryState,\n          timeLine: _historyCount,\n          flag: this.state.flag\n        })\n      } else {\n        pushState({\n          rootUrl: this.state.rootUrl,\n          flag: this.state.flag\n        }, true)\n      }\n      const preState = _history[_history.length - 1]\n      _history.push({\n        index: props.index,\n        key: props.key,\n        path: props.key,\n        data: props.data,\n        preState: preState,\n        timeLine: _historyCount\n      })\n\n      _historyCount++\n    }\n\n    historyPop() {\n      let state = _history.pop()\n      if (!state) return false\n      let rightState;\n      if (this.state.flag) {\n        rightState = (state && state.preState)\n        if (rightState) {\n          pushState({\n            index: rightState.index,\n            key: rightState.key,\n            data: rightState.data,\n            rootUrl: this.state.rootUrl,\n            preState: \"curHistoryState\",\n            flag: this.state.flag\n          })\n        }\n      } else {\n        rightState = _history.pop()\n        pushState({ rootUrl: this.state.rootUrl, flag: this.state.flag }, true)\n      }\n\n      return rightState\n    }\n\n    getRealContent(cnt, pre) {\n      if (!cnt) return ' '\n      let InstanceContext = this.saxer.get().InstanceContext || {}\n      let _pre = this.findPath(pre)\n      InstanceContext.from = (function () {\n        if (_pre) {\n          return {\n            index: _pre.index,\n            path: _pre.path,\n            title: _pre.title,\n            idf: _pre.idf,\n            parent: _pre.parent,\n            attr: _pre.attr\n          }\n        }\n      })()\n      const selectData = this.state.selectData\n      if (typeof cnt == 'function') {\n        let result = cnt(InstanceContext)\n        if (typeof result == 'object') {\n          if (result['$$typeof']) return result\n\n          // enter, leave, main, loaded\n          if (typeof result.enter == 'function') return result.enter(selectData)\n          else if (typeof result.main == 'function') {\n            return result.main(selectData)\n          }\n        }\n      }\n      return cnt\n    }\n\n    getPage(boxCls) {\n      // const xxid = this.saxer.get('__id')\n      // const operateId = xxid + '_OPERATE'\n      // const operate = this.saxer.get(operateId)\n\n      const id = this.state.select;\n      let pre, preId, prePage, preContent;\n      let oriContent, content;\n      oriContent = this.getContent(id);\n\n      if (this.state.direction == 'jumpback') {\n        // content = lru.get(id)\n        // if (!content) {\n        //   oriContent = this.getContent(id)\n        //   content = this.getRealContent(oriContent)\n        // }\n\n        pre = _leftStack.length ? _leftStack[_leftStack.length - 1] : '';\n        let rightIndex = _.findLastIndex(_history, function (o) { return o.index == id })\n        if (rightIndex > -1) {\n          rightIndex += 1\n          _history = _history.slice(0, rightIndex)\n          _leftStack = _leftStack.slice(0, (rightIndex))\n        }\n      }\n      else\n      if (this.state.direction == 'back') {\n        pre = _leftStack.pop()\n      } else {\n        pre = _leftStack.length ? _leftStack[_leftStack.length - 1] : '';\n      }\n\n      if (this.state.animate) {\n        if (this.state.animate == 'fade' || !opts.likeApp) {\n          prePage = undefined\n          this.prePageInfo = (pre && pre.id !== id) ? { origin: this.getContent(pre.id), ...pre} : ''\n        } else {\n          if (pre && pre.id !== id) {\n            this.prePageInfo = { origin: this.getContent(pre.id), ...pre}\n            preContent = lru.get(pre.id)\n            if (!preContent) {\n              preContent = this.getRealContent(this.getContent(pre.id))\n            }\n            prePage = <div ref='prePage' key={utile.uniqueId('Router_Single_')} className={boxCls}>{preContent}</div>\n          }\n        }\n      }\n\n      content = this.getRealContent(oriContent, pre)\n\n      const curPage = <div\n        ref=\"curPage\"\n        key={utile.uniqueId('Router_Single_')}\n        className={boxCls}>\n        {content}\n      </div>\n\n      // 下面的部分有顺序要求，不能随意放置\n      if (this.state.direction == 'goto') {\n        _leftStack.push({\n          id: id,\n        })\n      }\n\n      lru.set(id, content)\n\n      // if (operate == 'break') {\n      //   setTimeout(() => {\n      //     Progress.$width({width: \"100%\"})\n      //     setTimeout(() => {\n      //       Progress.$opacity({opacity: \"0\"})\n      //       setTimeout(() => {\n      //         Progress.$width({width: \"0\"})\n      //         setTimeout(() => {\n      //           Progress.$opacity({opacity: \"1\"})\n      //         }, 200);\n      //       }, 400);\n      //     }, 500);\n      //   }, 1000);\n      //   this.saxer.set(operateId, 'continue')\n      // }\n\n      if (prePage) {\n        return [ prePage, curPage ]\n      } else {\n        return [ curPage ]\n      }\n    }\n\n    leaveContent() {\n      if (this.prePageInfo) {\n        const InstanceContext = this.saxer.get().InstanceContext\n        const _pre = this.prePageInfo.origin\n        if (typeof _pre == 'function') {\n          let result = _pre(InstanceContext)\n          if (typeof result == 'object') {\n            if (typeof result.leave == 'function') return result.leave()\n          }\n        }\n      }\n    }\n\n    componentDidMount() {\n      let animatein = this.animatein\n      let animateout = this.animateout\n      if (this.state.direction == 'back' || this.state.direction == 'jumpback') {\n        animateout = this.animateback\n        animatein = this.animaterein\n      }\n      const curPageDom = this.refs.curPage\n      const prePageDom = this.refs.prePage\n      if (curPageDom) {\n        curPageDom.classList.value += animatein\n      }\n      if (prePageDom) {\n        prePageDom.classList.value += animateout\n      }\n      this.leaveContent()\n    }\n\n    render() {\n      const cls = !this.props.routerClass ? 'routerGroup ' : 'routerGroup ' + this.props.routerClass\n      const boxes_cls = !this.props.mulitple ? (this.props.animate == 'left' ? 'routerBoxes boxLeft' : this.props.animate == 'right' ? 'routerBoxes boxRight' : 'routerBoxes') : 'routerBoxes mulitple'\n      const jsxMenu = this.createMenu()\n\n      const content = this.getPage(boxes_cls)\n      const IscrollTreeMenu = Aotoo.iscroll(\n        <div className='routerMenus'>{jsxMenu}</div>, \n        opts.iscrollConfig\n      )\n\n      return (\n        <div className={cls}>\n          <Progress.x {...opts.progress}/>\n          {this.state.showMenu ? <IscrollTreeMenu /> : ''}\n          {content}\n        </div>\n      )\n    }\n  }\n\n  const Action = {\n    UPDATE: function (ostate, opts, ctx) {\n      let state = this.curState\n      state.data = opts.data\n      return state\n    },\n\n    SELECT: function (ostate, opts, ctx) {\n      let state = this.curState\n\n      // select\n      state.select = opts.select\n\n      // selectData\n      if (opts.selectData) {\n        state.selectData = opts.selectData\n      }\n\n      if (opts.direction) {\n        state.direction = opts.direction || 'goto'\n      }\n\n      if (state.direction == 'goto') {\n        ctx.emit('historypush', {\n          path: state.select,\n          data: state.selectData\n        })\n      }\n\n      if (typeof opts.cb == 'function') {\n        setTimeout(function () { opts.cb() }, 100);\n      }\n\n      return state\n    },\n  }\n\n  // const router = Aotoo(Tabs, Action, dft)\n  let router = Aotoo(Router, Action, dft)\n  router.__id = _.uniqueId('ROUTER_ID_')\n  router.saxer.set('__id', router.__id)\n  router.condition = {\n    preback: 'preback'\n  }\n  \n  router.on('rendered', function(params) {\n    const {context} = params\n    const xxid = context.saxer.get('__id')\n    const operateId = xxid + '_OPERATE'\n    const operate = context.saxer.get(operateId)\n\n    if (operate == 'break') {\n      setTimeout(() => {\n        Progress.$width({width: \"100%\"})\n        setTimeout(() => {\n          Progress.$opacity({opacity: \"0\"})\n          setTimeout(() => {\n            Progress.$width({width: \"0\"})\n            setTimeout(() => {\n              Progress.$opacity({opacity: \"1\"})\n              context.saxer.set(operateId, 'continue')\n            }, 200);\n          }, 100);\n        }, 100);\n      }, 500);\n    }\n  })\n\n  router.saxer.append({\n    InstanceContext: router\n  })\n\n  router.progress = {\n    start: function(param) {\n      if (typeof param == 'object' && param.width) {\n        Progress.$width(param)\n      }\n    },\n    end: function(timeout=1000) {\n      Progress.$width({width: \"100%\"})\n      setTimeout(() => {\n        Progress.$opacity({opacity: \"0\"})\n        setTimeout(() => {\n          Progress.$width({width: \"0\"})\n        }, 300);\n      }, timeout);\n    }\n  }\n\n  Popstate.on('__goback', function (param) {\n    return router.back()\n\n    // let hash\n    // if (param.href.indexOf('#')>-1) {\n    //   hash = param.href.substr(param.href.indexOf('#')+1)\n    // }\n    // // if (!hash) {\n    // //   return router.back()\n    // // }\n    // if (hash) {\n    //   const lastItem = _history[(_history.length - 1)]\n    //   if (hash !== lastItem.path) {\n    //     return router.back()\n    //   }\n    // }\n  })\n\n  let timmer = {\n    goto: '',\n    back: ''\n  }\n\n  router.extend({\n    getWhereInfo: function (where) {\n      const menu_data = this.saxer.get().MenuData\n      return utile.find(menu_data, { path: where })\n    },\n    getHistory: function (params) {\n      return _history\n    },\n    setHistory: function (record) {\n      if (record) {\n        _history = record.history || _history\n        _leftStack = record.stack || _leftStack\n      }\n    },\n    clearHistory: function (params) {\n      _history = []\n      _leftStack = []\n    },\n    start: function (id, data) {\n      if (this.hasMounted()) {\n        this.goto(id, data)\n      } else {\n        if (this.config && this.config.props) {\n          this.config.props.select = id\n          this.config.props.selectData = data\n        }\n      }\n    },\n    delete: function () {\n      let sessName\n      if (this.storageName) {\n        sessName = this.storageName\n        if (dft.storage[sessName]) {\n          dft.storage.removeItem(sessName)\n          return true\n        }\n      }\n    },\n    save: function (name, params) {\n      let sessName\n      if (name) {\n        sessName = name\n        const his = JSON.stringify(_history)\n        const stack = JSON.stringify(_leftStack)\n        const cur = _history[_history.length - 1]\n\n        const sessData = {\n          from: window.location,\n          history: _history,\n          stack: _leftStack,\n          current: cur\n        }\n        this.storageName = sessName\n        dft.storage.setItem(sessName, JSON.stringify(sessData))\n      }\n    },\n    restore: function (name, params) {\n      let sessName\n      if (name) {\n        // sessName = name + '_' + this.globalName\n        sessName = name\n        if (dft.storage[sessName]) {\n          const sessData = JSON.parse(dft.storage[sessName])\n          dft.storage.removeItem(sessName)\n\n          if (sessData.history.length) {\n            var cur = {\n              page: sessData.history.pop(),\n              stack: sessData.stack.pop()\n            }\n\n            _history = sessData.history\n            _leftStack = sessData.stack\n\n            // _history.pop()\n            // _leftStack.pop()\n            this.start(\n              cur.page.path,\n              cur.page.data\n            )\n  \n            return true\n          }\n        }\n      }\n    },\n\n    goto: function (where, data) {\n      once.call(this, next => {\n        setTimeout(() => {\n          next()\n        }, __opts.gap);\n\n        const result_beforegoto = this.emit('_beforeGoto', {\n          record: {\n            history: _history,\n            // stack: _leftStack,\n          },\n          param: {\n            path: where,\n            data: data\n          },\n\n          setHistory: this.setHistory\n        })\n        this.off('_beforeGoto')\n\n        const resultBeforegoto = this.emit('beforeGoto', {\n          record: {\n            history: _history,\n            // stack: _leftStack,\n          },\n\n          param: {\n            path: where,\n            data: data\n          },\n\n          setHistory: this.setHistory\n        })\n\n        if (result_beforegoto) return\n        if (resultBeforegoto) return\n\n        if (typeof where != 'string') return\n        const target = this.getWhereInfo(where)\n        if (target) {\n          this.$select({\n            select: target.index,\n            selectData: data,\n            direction: 'goto'\n          })\n        }\n      })\n    },\n\n    back: function (where, data) {\n      once.call(this, next => {\n        setTimeout(() => {\n          next()\n        }, __opts.gap);\n        \n        const result_beforeback = this.emit('_beforeBack', {\n          record: {\n            history: _history,\n            // stack: _leftStack,\n          },\n          param: {\n            path: where,\n            data: data\n          },\n          setHistory: this.setHistory\n        })\n  \n        this.off('_beforeBack')\n  \n        const resultBeforeback = this.emit('beforeBack', {\n          record: {\n            history: _history,\n            // stack: _leftStack,\n          },\n          param: {\n            path: where,\n            data: data\n          },\n          setHistory: this.setHistory\n        })\n  \n        if (result_beforeback) return\n        if (resultBeforeback) return\n  \n        let condition = {}\n        if (this.hasOn('preback')) {\n          const h = _history[_history.length - 1]\n          const whereami = {\n            index: h.index,\n            path: h.path,\n            data: h.data,\n            pre: h.preState,\n            flag: h.flag\n          }\n          condition = this.emit('preback', whereami)\n          if (!condition) return\n        }\n        if (where) {\n          if (typeof where != 'string') return\n          const target = this.getWhereInfo(where)\n          if (target) {\n            this.$select({\n              select: target.index,\n              selectData: utile.merge({}, data, condition),\n              direction: 'jumpback'\n            })\n          }\n        } else {\n          const whereBack = this.emit('historypop')\n          // whereBack: {\n          // index: props.index,\n          // key: props.key,\n          // data: props.data,\n          // rootUrl: this.state.rootUrl,\n          // preState: curHistoryState,\n          // timeLine: _historyCount,\n          // flag: this.state.flag\n          //}\n          if (whereBack) {\n            this.$select({\n              select: whereBack.index,\n              selectData: utile.merge({}, whereBack.data, condition),\n              direction: 'back'\n            })\n            return whereBack\n          } else {\n            if (window.history.length) {\n              history.back()\n            } else {\n              pushState({ rootUrl: rootUrl }, true)\n            }\n          }\n        }\n      })\n    }\n  })\n\n  return router\n})"]}